{% extends "base.html" %}
{% block title %}B2B Management | FDK.cz{% endblock %}
{% block header_title %}ğŸ¤ B2B Management{% endblock %}
{% block header_subtitle %}SprÃ¡va B2B vztahÅ¯ a obchodnÃ­ch smluv{% endblock %}

{% block content %}
<!-- Breadcrumbs -->
<div style="margin-bottom: 1.5rem; background: linear-gradient(to right, #eff6ff, #eef2ff); border: 2px solid #bfdbfe; border-radius: 8px; padding: 1rem;">
  <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; flex-wrap: wrap;">
    <span style="color: #64748b;">ğŸ“ Kontext:</span>
    <span style="font-weight: 500; color: #1e293b;">Organizace</span>
    <span style="color: #9ca3af;">â†’</span>
    <span style="font-weight: 600; color: #1e293b;">B2B</span>
  </div>
</div>

<div class="max-w-6xl mx-auto">
  <!-- Actions -->
  <div class="content-card mb-6">
    <div class="flex flex-wrap gap-3">
      <a href="{% url 'create_b2b_company' %}" class="btn btn-primary">+ NovÃ¡ firma</a>
      <a href="{% url 'create_b2b_contract' %}" class="btn btn-secondary">+ NovÃ¡ smlouva</a>
      <a href="{% url 'list_b2b_companies' %}" class="btn btn-outline">VÅ¡echny firmy</a>
      <a href="{% url 'list_b2b_contracts' %}" class="btn btn-outline">VÅ¡echny smlouvy</a>
    </div>
  </div>

  <!-- Statistics -->
  <div class="stats-grid mb-6">
    <div class="stat-card">
      <div style="display: flex; justify-content: space-between; align-items: flex-start;">
        <div>
          <div class="stat-title">Celkem firem</div>
          <div class="stat-value">{{ total_companies|default:0 }}</div>
        </div>
        <div class="stat-icon primary">ğŸ“Š</div>
      </div>
    </div>
    <div class="stat-card">
      <div style="display: flex; justify-content: space-between; align-items: flex-start;">
        <div>
          <div class="stat-title">Celkem smluv</div>
          <div class="stat-value">{{ total_contracts|default:0 }}</div>
        </div>
        <div class="stat-icon success">ğŸ“„</div>
      </div>
    </div>
    <div class="stat-card">
      <div style="display: flex; justify-content: space-between; align-items: flex-start;">
        <div>
          <div class="stat-title">AktivnÃ­ch smluv</div>
          <div class="stat-value">{{ active_contracts|default:0 }}</div>
        </div>
        <div class="stat-icon info">âœ…</div>
      </div>
    </div>
  </div>

  <!-- Recent Companies -->
  <div class="content-card mb-6">
    <h3 class="text-xl font-semibold mb-4">NedÃ¡vno pÅ™idanÃ© firmy</h3>
    {% if companies %}
    <div class="overflow-x-auto">
      <table class="data-table">
        <thead>
          <tr>
            <th>NÃ¡zev</th>
            <th>Kategorie</th>
            <th>Kontakt</th>
            <th class="text-center">Smlouvy</th>
            <th class="text-center">Akce</th>
          </tr>
        </thead>
        <tbody>
          {% for company in companies %}
          <tr>
            <td>
              <a href="{% url 'detail_b2b_company' company.company_id %}" class="text-blue-600 hover:underline font-medium">
                {{ company.name }}
              </a>
            </td>
            <td>
              <span class="px-2 py-1 bg-gray-200 rounded text-sm">{{ company.get_category_display }}</span>
            </td>
            <td>{{ company.email|default:"-" }}</td>
            <td class="text-center">
              <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm font-medium">{{ company.contracts_count }}</span>
            </td>
            <td class="text-center">
              <div class="data-table-actions">
                <a href="{% url 'detail_b2b_company' company.company_id %}">ğŸ‘ï¸ Detail</a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="text-center py-12 bg-gray-50 rounded-lg">
      <div class="text-5xl mb-3">ğŸ¤</div>
      <p class="text-gray-600 mb-4">ZatÃ­m nejsou Å¾Ã¡dnÃ© B2B firmy.</p>
      <a href="{% url 'create_b2b_company' %}" class="btn btn-primary">+ VytvoÅ™it prvnÃ­ firmu</a>
    </div>
    {% endif %}
  </div>

  <!-- Recent Contracts -->
  <div class="content-card">
    <h3 class="text-xl font-semibold mb-4">NedÃ¡vnÃ© smlouvy</h3>
    {% if recent_contracts %}
    <div class="overflow-x-auto">
      <table class="data-table">
        <thead>
          <tr>
            <th>ÄŒÃ­slo smlouvy</th>
            <th>NÃ¡zev</th>
            <th>Firma</th>
            <th>Status</th>
            <th class="text-center">Akce</th>
          </tr>
        </thead>
        <tbody>
          {% for contract in recent_contracts %}
          <tr>
            <td>
              <a href="{% url 'detail_b2b_contract' contract.contract_id %}" class="text-blue-600 hover:underline font-medium">
                {{ contract.contract_number }}
              </a>
            </td>
            <td>{{ contract.title }}</td>
            <td>{{ contract.company.name }}</td>
            <td>
              <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm">{{ contract.get_status_display }}</span>
            </td>
            <td class="text-center">
              <div class="data-table-actions">
                <a href="{% url 'detail_b2b_contract' contract.contract_id %}">ğŸ‘ï¸ Detail</a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="text-center py-12 bg-gray-50 rounded-lg">
      <div class="text-5xl mb-3">ğŸ“„</div>
      <p class="text-gray-600 mb-4">ZatÃ­m nejsou Å¾Ã¡dnÃ© B2B smlouvy.</p>
      <a href="{% url 'create_b2b_contract' %}" class="btn btn-primary">+ VytvoÅ™it prvnÃ­ smlouvu</a>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}