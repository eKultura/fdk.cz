{% extends 'base.html' %}
{% load i18n %}

{% block title %}Z√°kony a p≈ôedpisy | FDK.cz{% endblock %}
{% block header_title %}üìö Z√°kony a pr√°vn√≠ p≈ôedpisy{% endblock %}
{% block header_subtitle %}Kompletn√≠ datab√°ze ƒçesk√Ωch z√°kon≈Ø, vyhl√°≈°ek a pr√°vn√≠ch p≈ôedpis≈Ø{% endblock %}

{% block content %}
<div style="max-width: 1400px; margin: 0 auto;">

  <!-- Filters and Actions -->
  <div class="content-card" style="margin-bottom: 1.5rem;">
    <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; justify-content: space-between;">
      <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
        <div>
          <label style="font-weight: 500; color: #374151; margin-right: 0.5rem;">Kategorie:</label>
          <select style="padding: 8px 12px; border: 1px solid #e2e8f0; border-radius: 6px; background: white;" onchange="filterByCategory(this.value)">
            <option value="">V≈°echny kategorie</option>
            {% for category in categories %}
            <option value="{{ category }}" {% if category == selected_category %}selected{% endif %}>{{ category }}</option>
            {% endfor %}
          </select>
        </div>

        <div>
          <label style="font-weight: 500; color: #374151; margin-right: 0.5rem;">≈òazen√≠:</label>
          <select style="padding: 8px 12px; border: 1px solid #e2e8f0; border-radius: 6px; background: white;" onchange="sortLaws(this.value)">
            <option value="year-desc">Podle roku (nejnovƒõj≈°√≠)</option>
            <option value="year-asc">Podle roku (nejstar≈°√≠)</option>
            <option value="title">Podle n√°zvu</option>
            <option value="number">Podle ƒç√≠sla</option>
          </select>
        </div>
      </div>

      <div>
        <a href="{% url 'pravo_ai' %}" class="btn btn-outline">‚Üê Zpƒõt na AI Pr√°vo</a>
      </div>
    </div>
  </div>

  <!-- Laws List -->
  <div class="content-card">
    <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem;">üìö Seznam z√°kon≈Ø ({{ laws|length }})</h3>

    {% if laws %}
    <div style="display: grid; gap: 1rem;">
      {% for law in laws %}
      <div class="law-card" style="border: 1px solid #e2e8f0; border-radius: 8px; padding: 1.5rem; transition: all 0.2s; cursor: pointer;" onclick="window.location.href='{% url 'law_detail' law.id %}'">
        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
          <div style="flex: 1;">
            <h4 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem; color: #1e293b;">
              <a href="{% url 'law_detail' law.id %}" style="text-decoration: none; color: inherit;">
                {{ law.title }}
              </a>
            </h4>
            <div style="display: flex; gap: 1rem; margin-bottom: 0.5rem; align-items: center;">
              <span style="font-weight: 600; color: #3b82f6;">{{ law.number }}/{{ law.year }}</span>
              <span style="background: #f1f5f9; padding: 4px 12px; border-radius: 12px; font-size: 0.875rem; color: #64748b;">
                {{ law.category }}
              </span>
            </div>
          </div>

          <div style="text-align: right;">
            <div style="color: #64748b; font-size: 0.875rem;">Rok vyd√°n√≠</div>
            <div style="font-weight: 600; color: #1e293b; font-size: 1.25rem;">{{ law.year }}</div>
          </div>
        </div>

        <div style="display: flex; gap: 1rem;">
          <button class="btn btn-outline btn-sm" onclick="event.stopPropagation(); analyzeWithAI({{ law.id }})">
            ü§ñ AI Anal√Ωza
          </button>
          <a href="{% url 'law_detail' law.id %}" class="btn btn-primary btn-sm" onclick="event.stopPropagation()">
            üìñ Detail z√°kona
          </a>
        </div>
      </div>
      {% endfor %}
    </div>

    {% else %}
    <div style="text-align: center; padding: 3rem; background: #f8fafc; border-radius: 8px;">
      <div style="font-size: 3rem; margin-bottom: 1rem;">üìö</div>
      <h3 style="font-size: 1.25rem; font-weight: 600; color: #1e293b; margin-bottom: 0.5rem;">≈Ω√°dn√© z√°kony nenalezeny</h3>
      <p style="color: #64748b; margin-bottom: 1.5rem;">Zkuste zmƒõnit filtry nebo vyhled√°vac√≠ krit√©ria.</p>
      <a href="{% url 'law_list' %}" class="btn btn-primary">Zobrazit v≈°echny z√°kony</a>
    </div>
    {% endif %}
  </div>

  <!-- Quick Stats -->
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1.5rem;">
    <div class="content-card" style="text-align: center; background: linear-gradient(135deg, #eff6ff, #dbeafe);">
      <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìö</div>
      <div style="font-weight: 700; font-size: 1.5rem; color: #1e293b; margin-bottom: 0.25rem;">{{ laws|length }}</div>
      <div style="color: #475569; font-size: 0.875rem;">Dostupn√Ωch z√°kon≈Ø</div>
    </div>

    <div class="content-card" style="text-align: center; background: linear-gradient(135deg, #f0fdf4, #dcfce7);">
      <div style="font-size: 2rem; margin-bottom: 0.5rem;">üîç</div>
      <div style="font-weight: 700; font-size: 1.5rem; color: #1e293b; margin-bottom: 0.25rem;">{{ categories|length }}</div>
      <div style="color: #475569; font-size: 0.875rem;">Pr√°vn√≠ch oblast√≠</div>
    </div>

    <div class="content-card" style="text-align: center; background: linear-gradient(135deg, #fefce8, #fef3c7);">
      <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚ö°</div>
      <div style="font-weight: 700; font-size: 1.5rem; color: #1e293b; margin-bottom: 0.25rem;">24/7</div>
      <div style="color: #475569; font-size: 0.875rem;">AI asistent</div>
    </div>

    <div class="content-card" style="text-align: center; background: linear-gradient(135deg, #fef2f2, #fee2e2);">
      <div style="font-size: 2rem; margin-bottom: 0.5rem;">üî•</div>
      <div style="font-weight: 700; font-size: 1.5rem; color: #1e293b; margin-bottom: 0.25rem;">Dennƒõ</div>
      <div style="color: #475569; font-size: 0.875rem;">Aktualizace</div>
    </div>
  </div>

</div>

<style>
  .law-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    border-color: #3b82f6 !important;
  }
</style>

<script>
  // Filter by category
  function filterByCategory(category) {
    const url = new URL(window.location);
    if (category) {
      url.searchParams.set('category', category);
    } else {
      url.searchParams.delete('category');
    }
    window.location.href = url.toString();
  }

  // Sort laws
  function sortLaws(sortBy) {
    const url = new URL(window.location);
    url.searchParams.set('sort', sortBy);
    window.location.href = url.toString();
  }

  // AI Analysis
  function analyzeWithAI(lawId) {
    if (confirm('Chcete analyzovat tento z√°kon pomoc√≠ AI? Bude vytvo≈ôen nov√Ω dotaz.')) {
      window.location.href = `/dotaz/?law_id=${lawId}`;
    }
  }
</script>
{% endblock %}
