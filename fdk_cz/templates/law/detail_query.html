{% extends "base.html" %}
{% block title %}{{ query.title }} | FDK.cz{% endblock %}
{% block header_title %}ï¿½ Detail AI dotazu{% endblock %}
{% block header_subtitle %}{{ query.title }}{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto">
  <!-- Status and Actions -->
  <div class="mb-6 flex justify-between items-center">
    <div>
      <span class="px-3 py-1 rounded-full text-sm font-medium
        {% if query.status == 'completed' %}bg-green-100 text-green-700
        {% elif query.status == 'processing' %}bg-blue-100 text-blue-700
        {% elif query.status == 'pending' %}bg-yellow-100 text-yellow-700
        {% else %}bg-red-100 text-red-700{% endif %}">
        {% if query.status == 'completed' %} Dokoneno
        {% elif query.status == 'processing' %}ï¿½ Zpracovï¿½vï¿½ se
        {% elif query.status == 'pending' %} ekï¿½ na zpracovï¿½nï¿½
        {% else %}L Chyba{% endif %}
      </span>
    </div>
    <div class="flex gap-3">
      <a href="{% url 'law_dashboard' %}" class="btn btn-outline">ï¿½ Zpt na dashboard</a>
      <a href="{% url 'law_query' %}" class="btn btn-secondary">+ NovÃ½ dotaz</a>
    </div>
  </div>

  <!-- Query Question -->
  <div class="content-card mb-6">
    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
      <span class="text-2xl mr-2">S</span>
      Vï¿½a dotaz
    </h3>
    <div class="bg-gray-50 border-l-4 border-blue-500 rounded-lg p-4">
      <p class="text-gray-800 leading-relaxed whitespace-pre-wrap">{{ query.question }}</p>
    </div>
    <div class="mt-3 flex items-center text-sm text-gray-500">
      <span>=ï¿½ VytvoYeno: {{ query.created_at|date:"d.m.Y H:i" }}</span>
      {% if query.updated_at %}
        <span class="mx-2">"</span>
        <span>= Aktualizovï¿½no: {{ query.updated_at|date:"d.m.Y H:i" }}</span>
      {% endif %}
    </div>
  </div>

  <!-- AI Response -->
  {% if query.status == 'completed' and query.ai_response %}
  <div class="content-card">
    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
      <span class="text-2xl mr-2">></span>
      AI Odpov
    </h3>
    <div class="bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-5">
      <div class="prose max-w-none">
        {{ query.ai_response|linebreaks }}
      </div>
    </div>

    <!-- Response Actions -->
    <div class="mt-4 pt-4 border-t border-gray-200 flex gap-3">
      <button class="btn btn-outline" onclick="copyToClipboard()">=ï¿½ Kopï¿½rovat odpov</button>
      <button class="btn btn-outline" onclick="window.print()">=ï¿½ Tisk</button>
      <button class="btn btn-outline">=ï¿½ Export PDF</button>
    </div>
  </div>
  {% elif query.status == 'processing' %}
  <div class="content-card text-center">
    <div class="py-12">
      <div class="text-6xl mb-4">ï¿½</div>
      <h3 class="text-xl font-semibold text-gray-800 mb-2">Zpracovï¿½vï¿½ se...</h3>
      <p class="text-gray-600">AI prï¿½vnï¿½ asistent prï¿½v analyzuje vï¿½a dotaz. Tento proces mo~e trvat nkolik minut.</p>
      <div class="mt-6">
        <div class="animate-pulse bg-blue-100 h-2 rounded-full w-64 mx-auto"></div>
      </div>
    </div>
  </div>
  {% elif query.status == 'pending' %}
  <div class="content-card text-center">
    <div class="py-12">
      <div class="text-6xl mb-4"></div>
      <h3 class="text-xl font-semibold text-gray-800 mb-2">ekï¿½ na zpracovï¿½nï¿½</h3>
      <p class="text-gray-600">Vï¿½a dotaz je ve front a bude brzy zpracovï¿½n.</p>
    </div>
  </div>
  {% else %}
  <div class="content-card text-center">
    <div class="py-12">
      <div class="text-6xl mb-4">L</div>
      <h3 class="text-xl font-semibold text-gray-800 mb-2">Chyba pYi zpracovï¿½nï¿½</h3>
      <p class="text-gray-600">PYi zpracovï¿½nï¿½ dotazu doalo k chyb. Zkuste prosï¿½m dotaz odeslat znovu.</p>
      <div class="mt-4">
        <a href="{% url 'law_query' %}" class="btn btn-primary">Zkusit znovu</a>
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Disclaimer -->
  <div class="bg-yellow-50 border-2 border-yellow-200 rounded-lg p-4 mt-6">
    <div class="flex items-start">
      <div class="text-2xl mr-3">ï¿½</div>
      <div>
        <h4 class="font-semibold text-yellow-800 mb-1">Prï¿½vnï¿½ upozornnï¿½</h4>
        <p class="text-sm text-yellow-700">
          Odpovdi AI asistenta jsou poskytovï¿½ny pouze pro informanï¿½ ï¿½ely a nepYedstavujï¿½ prï¿½vnï¿½ poradenstvï¿½.
          Pro konkrï¿½tnï¿½ prï¿½vnï¿½ pYï¿½pady doporuujeme konzultaci s advokï¿½tem nebo prï¿½vnï¿½kem.
        </p>
      </div>
    </div>
  </div>
</div>

<script>
function copyToClipboard() {
  const response = document.querySelector('.prose').innerText;
  navigator.clipboard.writeText(response).then(() => {
    alert('Odpov zkopï¿½rovï¿½na do schrï¿½nky!');
  });
}
</script>
{% endblock %}
