{% extends "base.html" %}
{% block title %}OddÄ›lenÃ­ | FDK.cz{% endblock %}
{% block header_title %}ğŸ¢ OddÄ›lenÃ­{% endblock %}
{% block header_subtitle %}OrganizaÄnÃ­ struktura a oddÄ›lenÃ­ firmy{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
  <!-- Actions -->
  <div class="mb-6 flex gap-3">
    <a href="{% url 'create_department' %}" class="btn btn-primary">+ NovÃ© oddÄ›lenÃ­</a>
    <a href="{% url 'hr_dashboard' %}" class="btn btn-outline">â† Dashboard</a>
  </div>

  <!-- Departments Table -->
  <div class="content-card">
    {% if departments %}
      <div class="overflow-x-auto">
        <table class="data-table">
          <thead>
            <tr>
              <th>NÃ¡zev oddÄ›lenÃ­</th>
              <th class="hidden md:table-cell">Organizace</th>
              <th class="hidden lg:table-cell">ManaÅ¾er</th>
              <th class="hidden lg:table-cell">NadÅ™azenÃ© oddÄ›lenÃ­</th>
              <th class="text-center">ZamÄ›stnancÅ¯</th>
              <th class="text-right">Akce</th>
            </tr>
          </thead>
          <tbody>
            {% for department in departments %}
              <tr>
                <td>
                  <a href="{% url 'detail_department' department.department_id %}" class="font-semibold text-blue-600 hover:underline">
                    ğŸ¢ {{ department.name }}
                  </a>
                  {% if department.description %}
                    <div class="text-xs text-gray-500 mt-1">
                      {{ department.description|truncatewords:15 }}
                    </div>
                  {% endif %}
                </td>
                <td class="hidden md:table-cell text-gray-600">
                  <a href="{% url 'organization_detail' department.organization.organization_id %}" class="text-blue-600 hover:underline">
                    {{ department.organization.name }}
                  </a>
                </td>
                <td class="hidden lg:table-cell text-gray-600">
                  {% if department.manager %}
                    {{ department.manager.get_full_name|default:department.manager.username }}
                  {% else %}
                    â€”
                  {% endif %}
                </td>
                <td class="hidden lg:table-cell text-gray-600">
                  {% if department.parent_department %}
                    <a href="{% url 'detail_department' department.parent_department.department_id %}" class="text-blue-600 hover:underline">
                      {{ department.parent_department.name }}
                    </a>
                  {% else %}
                    â€”
                  {% endif %}
                </td>
                <td class="text-center">
                  <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-bold">
                    {{ department.employee_count|default:0 }}
                  </span>
                </td>
                <td class="text-right">
                  <div class="data-table-actions">
                    <a href="{% url 'detail_department' department.department_id %}">ğŸ‘ï¸ Detail</a>
                    <a href="{% url 'edit_department' department.department_id %}">âœï¸ Upravit</a>
                  </div>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- Results Summary -->
      <div class="mt-4 text-sm text-gray-600 text-center">
        Celkem {{ departments.count }} oddÄ›lenÃ­
      </div>
    {% else %}
      <div class="text-center py-12 bg-gray-50 rounded-lg">
        <div class="text-5xl mb-3">ğŸ¢</div>
        <p class="text-gray-600 mb-4">
          ZatÃ­m nemÃ¡te vytvoÅ™enÃ¡ Å¾Ã¡dnÃ¡ oddÄ›lenÃ­
        </p>
        <a href="{% url 'create_department' %}" class="btn btn-primary">+ VytvoÅ™it prvnÃ­ oddÄ›lenÃ­</a>
      </div>
    {% endif %}
  </div>

  <!-- Info Card -->
  <div class="content-card mt-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200">
    <div class="flex items-start">
      <div class="text-3xl mr-4">ğŸ’¡</div>
      <div>
        <h4 class="font-semibold text-gray-800 mb-2">Tipy pro organizaÄnÃ­ strukturu</h4>
        <ul class="text-sm text-gray-700 space-y-1 list-disc list-inside">
          <li>VytvoÅ™te hierarchii oddÄ›lenÃ­ pomocÃ­ nadÅ™azenÃ½ch oddÄ›lenÃ­</li>
          <li>PÅ™iÅ™aÄte manaÅ¾ery k jednotlivÃ½m oddÄ›lenÃ­m pro lepÅ¡Ã­ sprÃ¡vu</li>
          <li>Organizujte zamÄ›stnance do oddÄ›lenÃ­ podle jejich pracovnÃ­ nÃ¡plnÄ›</li>
          <li>PouÅ¾Ã­vejte popis oddÄ›lenÃ­ pro dokumentaci jeho Äinnosti</li>
          <li>Sledujte poÄet zamÄ›stnancÅ¯ v kaÅ¾dÃ©m oddÄ›lenÃ­</li>
        </ul>
      </div>
    </div>
  </div>
</div>
{% endblock %}
