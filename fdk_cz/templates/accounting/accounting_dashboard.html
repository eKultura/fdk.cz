{% extends "base.html" %}
{% block title %}ÃšÄetnictvÃ­ | FDK.cz{% endblock %}
{% block header_title %}ğŸ’° ÃšÄetnictvÃ­{% endblock %}
{% block header_subtitle %}SprÃ¡va faktur a penÄ›Å¾nÃ­ch denÃ­kÅ¯{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
  <!-- Navigation Cards -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
    <a href="{% url 'create_invoice' %}" class="content-card hover:shadow-lg transition cursor-pointer">
      <div class="text-center p-4">
        <div class="text-3xl mb-2">ğŸ“„</div>
        <h3 class="font-semibold text-gray-800">Faktury</h3>
        <p class="text-sm text-gray-600 mt-1">SprÃ¡va faktur</p>
      </div>
    </a>
    <a href="{% url 'journal_ledger' %}" class="content-card hover:shadow-lg transition cursor-pointer">
      <div class="text-center p-4">
        <div class="text-3xl mb-2">ğŸ“š</div>
        <h3 class="font-semibold text-gray-800">ÃšÄetnÃ­ denÃ­k</h3>
        <p class="text-sm text-gray-600 mt-1">PodvojnÃ© ÃºÄetnictvÃ­</p>
      </div>
    </a>
    <a href="{% url 'balance_sheet_view' 'opening' %}" class="content-card hover:shadow-lg transition cursor-pointer">
      <div class="text-center p-4">
        <div class="text-3xl mb-2">ğŸ“Š</div>
        <h3 class="font-semibold text-gray-800">Rozvaha</h3>
        <p class="text-sm text-gray-600 mt-1">PoÄÃ¡teÄnÃ­ / KoneÄnÃ¡</p>
      </div>
    </a>
    <a href="{% url 'chart_of_accounts' %}" class="content-card hover:shadow-lg transition cursor-pointer">
      <div class="text-center p-4">
        <div class="text-3xl mb-2">ğŸ“‹</div>
        <h3 class="font-semibold text-gray-800">ÃšÄtovÃ¡ osnova</h3>
        <p class="text-sm text-gray-600 mt-1">SprÃ¡va ÃºÄtÅ¯</p>
      </div>
    </a>
  </div>

  <!-- Income Statement (VÃ½sledovka) -->
  <div class="content-card mb-6">
    <h3 class="text-xl font-semibold mb-4 text-gray-800">ğŸ“ˆ VÃ½sledovka â€“ BÄ›Å¾nÃ© obdobÃ­</h3>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <!-- Revenues -->
      <div class="p-5 bg-green-50 rounded-lg border border-green-200">
        <h4 class="text-sm font-semibold text-green-800 mb-2">ğŸ’° VÃ½nosy</h4>
        <p class="text-3xl font-bold text-green-700">{{ total_revenues|default:0|floatformat:2 }} KÄ</p>
        <p class="text-xs text-green-600 mt-1">ÃšÄty 6xx</p>
      </div>
      <!-- Expenses -->
      <div class="p-5 bg-red-50 rounded-lg border border-red-200">
        <h4 class="text-sm font-semibold text-red-800 mb-2">ğŸ’¸ NÃ¡klady</h4>
        <p class="text-3xl font-bold text-red-700">{{ total_expenses|default:0|floatformat:2 }} KÄ</p>
        <p class="text-xs text-red-600 mt-1">ÃšÄty 5xx</p>
      </div>
      <!-- Profit/Loss -->
      <div class="p-5 {% if profit >= 0 %}bg-blue-50 border-blue-200{% else %}bg-orange-50 border-orange-200{% endif %} rounded-lg border">
        <h4 class="text-sm font-semibold {% if profit >= 0 %}text-blue-800{% else %}text-orange-800{% endif %} mb-2">
          {% if profit >= 0 %}ğŸ“Š Zisk{% else %}ğŸ“‰ ZtrÃ¡ta{% endif %}
        </h4>
        <p class="text-3xl font-bold {% if profit >= 0 %}text-blue-700{% else %}text-orange-700{% endif %}">
          {{ profit|default:0|floatformat:2 }} KÄ
        </p>
        <p class="text-xs {% if profit >= 0 %}text-blue-600{% else %}text-orange-600{% endif %} mt-1">VÃ½nosy - NÃ¡klady</p>
      </div>
    </div>
  </div>

  <!-- Statistics -->
  <div class="stats-grid mb-6">
    <div class="stat-card">
      <div style="display: flex; justify-content: space-between; align-items: flex-start;">
        <div>
          <div class="stat-title">Celkem faktur</div>
          <div class="stat-value">{{ total_invoices|default:invoices|length|default:0 }}</div>
        </div>
        <div class="stat-icon primary">ğŸ“„</div>
      </div>
    </div>
    <div class="stat-card">
      <div style="display: flex; justify-content: space-between; align-items: flex-start;">
        <div>
          <div class="stat-title">NevyÅ™Ã­zenÃ½ch</div>
          <div class="stat-value">{{ pending_invoices|default:0 }}</div>
        </div>
        <div class="stat-icon warning">â³</div>
      </div>
    </div>
    <div class="stat-card">
      <div style="display: flex; justify-content: space-between; align-items: flex-start;">
        <div>
          <div class="stat-title">ZaplacenÃ½ch</div>
          <div class="stat-value">{{ paid_invoices|default:0 }}</div>
        </div>
        <div class="stat-icon success">âœ…</div>
      </div>
    </div>
  </div>

  <!-- Recent Invoices -->
  <div class="content-card">
    <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
      <h3 class="card-title" style="font-weight:600;font-size:1.1rem;">ğŸ“„ NedÃ¡vnÃ© faktury</h3>
      <div class="flex gap-2">
        <a href="{% url 'create_invoice' %}" class="btn btn-primary text-sm">&#10133; NovÃ¡ faktura</a>
        <a href="{% url 'list_invoices' %}" class="btn btn-outline text-sm">VÅ¡echny faktury</a>
      </div>
    </div>
    {% if invoices %}
    <div class="overflow-x-auto">
      <table class="data-table" style="width:100%;border-collapse:collapse;">
        <thead style="background:#f9fafb;">
          <tr>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold">ÄŒÃ­slo faktury</th>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold hidden md:table-cell">Datum vystavenÃ­</th>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold hidden md:table-cell">Datum splatnosti</th>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold hidden lg:table-cell">PlÃ¡tce</th>
            <th class="px-4 py-2 text-right text-gray-600 font-semibold">ÄŒÃ¡stka</th>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold">Stav</th>
            <th class="px-4 py-2 text-center text-gray-600 font-semibold w-1/6">Akce</th>
          </tr>
        </thead>
        <tbody>
          {% for invoice in invoices %}
          <tr style="border-bottom:1px solid #e5e7eb;" class="hover:bg-gray-50 transition">
            <td class="px-4 py-2 text-gray-800 font-medium">{{ invoice.invoice_number }}</td>
            <td class="px-4 py-2 text-gray-500 hidden md:table-cell">{{ invoice.issue_date|date:"d.m.Y"|default:"â€“" }}</td>
            <td class="px-4 py-2 text-gray-500 hidden md:table-cell">{{ invoice.due_date|date:"d.m.Y"|default:"â€“" }}</td>
            <td class="px-4 py-2 text-gray-500 hidden lg:table-cell">{{ invoice.company.name|default:"â€“" }}</td>
            <td class="px-4 py-2 text-right font-semibold text-gray-800">{{ invoice.total_amount|default:"â€“" }} KÄ</td>
            <td class="px-4 py-2">
              {% if invoice.status == 'paid' %}
                <span class="px-2 py-1 bg-green-100 text-green-700 rounded text-sm">âœ“ Zaplaceno</span>
              {% elif invoice.status == 'pending' %}
                <span class="px-2 py-1 bg-yellow-100 text-yellow-700 rounded text-sm">â³ ÄŒekÃ¡</span>
              {% elif invoice.status == 'overdue' %}
                <span class="px-2 py-1 bg-red-100 text-red-700 rounded text-sm">âš ï¸ Po splatnosti</span>
              {% else %}
                <span class="px-2 py-1 bg-gray-100 text-gray-700 rounded text-sm">{{ invoice.get_status_display }}</span>
              {% endif %}
            </td>
            <td class="px-4 py-2 text-center">
              <a href="{% url 'detail_invoice' invoice.id %}" class="text-blue-600 hover:text-blue-800 text-sm mr-2">Detail</a>
              <a href="{% url 'edit_invoice' invoice.id %}" class="text-yellow-600 hover:text-yellow-800 text-sm">Upravit</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="empty-state" style="text-align:center;padding:2rem;color:#6b7280;">
      <div style="font-size:2rem;">ğŸ“„</div>
      <p style="margin-top:0.5rem;">ZatÃ­m nemÃ¡te vytvoÅ™enÃ© Å¾Ã¡dnÃ© faktury.</p>
      <a href="{% url 'create_invoice' %}" class="btn btn-outline" style="margin-top:1rem;">â• VytvoÅ™it prvnÃ­ fakturu</a>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
