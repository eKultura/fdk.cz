{% extends "base.html" %}
{% block title %}Seznam rizik | FDK.cz{% endblock %}
{% block header_title %}‚ö†Ô∏è Seznam rizik{% endblock %}
{% block header_subtitle %}P≈ôehled identifikovan√Ωch rizik a jejich ≈ô√≠zen√≠{% endblock %}

{% block content %}
<!-- Breadcrumbs -->
<div style="margin-bottom: 1.5rem; background: linear-gradient(to right, #eff6ff, #eef2ff); border: 2px solid #bfdbfe; border-radius: 8px; padding: 1rem;">
  <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; flex-wrap: wrap;">
    <span style="color: #64748b;">üìç Kontext:</span>
    <span style="font-weight: 500; color: #1e293b;">Organizace</span>
    <span style="color: #9ca3af;">‚Üí</span>
    <a href="{% url 'risk_dashboard' %}" style="color: #3b82f6; text-decoration: none; font-weight: 500;">Rizika</a>
    <span style="color: #9ca3af;">‚Üí</span>
    <span style="font-weight: 600; color: #1e293b;">Seznam</span>
  </div>
</div>

<div style="max-width: 1400px; margin: 0 auto;">
  <!-- Actions -->
  <div class="mb-10 flex gap-3">
    <a href="{% url 'create_risk' %}" class="btn btn-primary">+ Nov√© riziko</a>
    <a href="{% url 'risk_dashboard' %}" class="btn btn-outline">Dashboard</a>
    <a href="{% url 'risk_matrix' %}" class="btn btn-outline">Rizikov√° matice</a>
  </div>

  <div class="content-card">
    {% if risks %}
      <!-- POVINN√ù overflow wrapper podle metodiky sekce 3.5 -->
      <div class="overflow-x-auto">
        <table class="data-table">
          <thead>
            <tr>
              <th>N√°zev rizika</th>
              <th class="hidden md:table-cell">Kategorie</th>
              <th class="hidden lg:table-cell text-center">Z√°va≈ænost</th>
              <th class="hidden lg:table-cell text-center">Pravdƒõpodobnost</th>
              <th class="text-right">Akce</th>
            </tr>
          </thead>
          <tbody>
            {% for risk in risks %}
            <tr>
              <td>
                <a href="{% url 'detail_risk' risk.risk_id %}" class="font-semibold text-blue-600 hover:underline">
                  {{ risk.title|safe }}
                </a>
                {% if risk.project %}
                <div class="text-xs text-gray-600 mt-1">
                  üìÅ {{ risk.project.name }}
                </div>
                {% endif %}
              </td>
              <td class="hidden md:table-cell text-gray-600">{{ risk.get_category_display }}</td>
              <td class="hidden lg:table-cell text-center">
                <span style="padding: 4px 8px; border-radius: 8px; font-size: 0.875rem; font-weight: 600; color: white; background: {% if risk.impact >= 4 %}#dc2626{% elif risk.impact >= 3 %}#f59e0b{% else %}#10b981{% endif %};">
                  {{ risk.get_impact_display }}
                </span>
              </td>
              <td class="hidden lg:table-cell text-center">
                <span style="padding: 4px 8px; border-radius: 8px; font-size: 0.875rem; font-weight: 600; color: white; background: {% if risk.probability >= 4 %}#dc2626{% elif risk.probability >= 3 %}#f59e0b{% else %}#10b981{% endif %};">
                  {{ risk.get_probability_display }}
                </span>
              </td>
              <td class="text-right">
                <div class="data-table-actions">
                  <a href="{% url 'detail_risk' risk.risk_id %}">üëÅÔ∏è Detail</a>
                  <a href="{% url 'edit_risk' risk.risk_id %}">‚úèÔ∏è Upravit</a>
                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div style="text-align: center; padding: 3rem;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
        <p style="color: #64748b;">Zat√≠m nejsou ≈æ√°dn√° rizika k zobrazen√≠.</p>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
