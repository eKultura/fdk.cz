{% extends "base.html" %}
{% block title %}Moje organizace | FDK.cz{% endblock %}
{% block header_title %}üè¢ Moje organizace{% endblock %}
{% block header_subtitle %}Spr√°va organizac√≠ a ƒçlenstv√≠{% endblock %}

{% block context_breadcrumbs %}
<span style="font-weight: 600; color: #1e293b;">Organizace</span>
{% endblock %}

{% block content %}

<div style="max-width: 1200px; margin: 0 auto;">

  <!-- Action Button -->
  <div style="margin-bottom: 2rem; display: flex; justify-content: flex-end;">
    <a href="{% url 'create_organization' %}" class="btn btn-primary">
      ‚ûï Vytvo≈ôit novou organizaci
    </a>
  </div>

  <!-- Owned Organizations -->
  <div class="content-card" style="margin-bottom: 2rem;">
    <h3 style="font-size: 1.25rem; font-weight: 600; color: #1e293b; margin-bottom: 1rem;">
      üëë Organizace, kter√© spravuji
    </h3>

    {% if owned_organizations %}
      <div style="display: grid; gap: 1rem;">
        {% for org in owned_organizations %}
        <div style="border: 2px solid #3b82f6; border-radius: 8px; padding: 1.5rem; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); transition: all 0.2s; {% if current_organization and org.organization_id == current_organization.organization_id %}box-shadow: 0 0 0 3px #93c5fd;{% endif %}">
          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
            <div style="flex: 1;">
              <h4 style="font-size: 1.125rem; font-weight: 600; color: #1e293b; margin-bottom: 0.5rem;">
                {{ org.name }}
                {% if current_organization and org.organization_id == current_organization.organization_id %}
                <span style="background: #10b981; color: white; padding: 0.125rem 0.5rem; border-radius: 4px; font-size: 0.75rem; margin-left: 0.5rem;">AKTIVN√ç</span>
                {% endif %}
              </h4>
              <div style="font-size: 0.875rem; color: #64748b;">
                IƒåO: <span style="font-weight: 500; color: #3b82f6;">{{ org.ico }}</span> ¬∑
                Vytvo≈ôeno: {{ org.created_at|date:"d.m.Y" }}
              </div>
            </div>
            <div style="display: flex; gap: 0.5rem;">
              {% if current_organization and org.organization_id == current_organization.organization_id %}
              <a href="{% url 'set_personal_context' %}" class="btn btn-outline btn-sm">
                ‚Üê Vystoupit
              </a>
              {% else %}
              <a href="{% url 'set_organization_context' org.organization_id %}" class="btn btn-primary btn-sm">
                Vstoupit ‚Üí
              </a>
              {% endif %}
              <a href="{% url 'organization_detail' org.organization_id %}" class="btn btn-outline btn-sm">
                Detail
              </a>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    {% else %}
      <div style="text-align: center; padding: 3rem; background: #f8fafc; border-radius: 8px;">
        <div style="font-size: 4rem; margin-bottom: 1rem;">üè¢</div>
        <p style="color: #64748b; margin-bottom: 1.5rem;">Zat√≠m nespravujete ≈æ√°dnou organizaci</p>
        <a href="{% url 'create_organization' %}" class="btn btn-primary">
          Vytvo≈ôit prvn√≠ organizaci
        </a>
      </div>
    {% endif %}
  </div>

  <!-- Member Organizations -->
  <div class="content-card">
    <h3 style="font-size: 1.25rem; font-weight: 600; color: #1e293b; margin-bottom: 1rem;">
      üë• Organizace, kde jsem ƒçlenem
    </h3>

    {% if member_organizations %}
      <div style="display: grid; gap: 1rem;">
        {% for org in member_organizations %}
        <div style="border: 1px solid #e2e8f0; border-radius: 8px; padding: 1.5rem; background: white; transition: all 0.2s; {% if current_organization and org.organization_id == current_organization.organization_id %}box-shadow: 0 0 0 3px #93c5fd;{% endif %}">
          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
            <div style="flex: 1;">
              <h4 style="font-size: 1.125rem; font-weight: 600; color: #1e293b; margin-bottom: 0.5rem;">
                {{ org.name }}
                {% if current_organization and org.organization_id == current_organization.organization_id %}
                <span style="background: #10b981; color: white; padding: 0.125rem 0.5rem; border-radius: 4px; font-size: 0.75rem; margin-left: 0.5rem;">AKTIVN√ç</span>
                {% endif %}
              </h4>
              <div style="font-size: 0.875rem; color: #64748b;">
                IƒåO: {{ org.ico }} ¬∑ Vlastn√≠k: {{ org.created_by.username }}
              </div>
            </div>
            <div style="display: flex; gap: 0.5rem;">
              {% if current_organization and org.organization_id == current_organization.organization_id %}
              <a href="{% url 'set_personal_context' %}" class="btn btn-outline btn-sm">
                ‚Üê Vystoupit
              </a>
              {% else %}
              <a href="{% url 'set_organization_context' org.organization_id %}" class="btn btn-primary btn-sm">
                Vstoupit ‚Üí
              </a>
              {% endif %}
              <a href="{% url 'organization_detail' org.organization_id %}" class="btn btn-outline btn-sm">
                Detail
              </a>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    {% else %}
      <div style="text-align: center; padding: 2rem; background: #f8fafc; border-radius: 8px;">
        <p style="color: #64748b;">Nejste ƒçlenem ≈æ√°dn√© organizace</p>
      </div>
    {% endif %}
  </div>

</div>
{% endblock %}
