{% extends "base.html" %}

{% block title %}
  {% if user.is_authenticated %}
    Dashboard | FDK.cz - Komplexn√≠ ≈ô√≠zen√≠ organizac√≠
  {% else %}
    FDK.cz - Komplexn√≠ ≈ô√≠zen√≠ organizac√≠
  {% endif %}
{% endblock %}

{% block header_title %}
  {% if user.is_authenticated %}
    V√≠tejte, {{ user.first_name|default:user.username }}!
  {% else %}
    FDK.cz - Komplexn√≠ ≈ô√≠zen√≠ organizac√≠
  {% endif %}
{% endblock %}

{% block header_subtitle %}
  {% if user.is_authenticated %}
    {% if user.companies.first %}
      {{ user.companies.first.name }} - IƒåO: {{ user.companies.first.ico }}
    {% else %}
      Dokonƒçete nastaven√≠ sv√© organizace pro pln√Ω p≈ô√≠stup k funkc√≠m
    {% endif %}
  {% else %}
    Modern√≠ platforma pro efektivn√≠ spr√°vu organizac√≠, projekt≈Ø a AI pr√°vn√≠ch n√°stroj≈Ø
  {% endif %}
{% endblock %}

{% block breadcrumb %}{% endblock %}

{% block content %}
<!-- Quick Actions Bar -->
{% if user.is_authenticated %}
<div style="display: flex; gap: 0.75rem; margin-bottom: 2rem; flex-wrap: wrap;">
  {% with url="new_project_cs" icon="üìÅ" label="Nov√Ω projekt" shortcut="Cmd+N" %}
    {% include 'inc/components.html' with component='quick_action' %}
  {% endwith %}

  {% with url="task_management" icon="‚úì" label="P≈ôidat √∫kol" shortcut="Cmd+T" %}
    {% include 'inc/components.html' with component='quick_action' %}
  {% endwith %}

  {% with url="my_contacts" icon="üë§" label="Nov√Ω kontakt" %}
    {% include 'inc/components.html' with component='quick_action' %}
  {% endwith %}

  {% with url="accounting_dashboard" icon="üí∞" label="√öƒçetnictv√≠" %}
    {% include 'inc/components.html' with component='quick_action' %}
  {% endwith %}
</div>
{% endif %}

<!-- Stats Grid -->
{% if user.is_authenticated %}
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;">
  {% with value=total_projects|default:"0" label="Projekty" icon="üìÅ" color="blue" %}
    {% include 'inc/components.html' with component='stat_card' %}
  {% endwith %}

  {% with value=open_tasks_count|default:"0" label="Otev≈ôen√© √∫koly" icon="‚úì" color="green" %}
    {% include 'inc/components.html' with component='stat_card' %}
  {% endwith %}

  {% with value=total_test_results|default:"0" label="Testy" icon="üß™" color="purple" %}
    {% include 'inc/components.html' with component='stat_card' %}
  {% endwith %}

  {% with value=total_users|default:"0" label="U≈æivatel√©" icon="üë•" color="orange" %}
    {% include 'inc/components.html' with component='stat_card' %}
  {% endwith %}
</div>
{% endif %}

<!-- AI Pr√°vo v√Ωstupy -->
        {% if user.is_authenticated and ai_outputs %}
        <div class="content-card" style="margin-bottom: 3rem;">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 1.5rem;">
            <div style="font-size: 1.5rem;">&#9889;</div>
            <div>
              <h2 style="font-size: 1.25rem; font-weight: 600; margin: 0;">AI Pr√°vo v√Ωstupy</h2>
              <p style="color: #64748b; margin: 0; font-size: 0.875rem;">Posledn√≠ anal√Ωzy a dokumenty z AI syst√©mu</p>
            </div>
          </div>

          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
            {% for output in ai_outputs|slice:":3" %}
            <div class="ai-output-item">
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 0.5rem;">
                <span style="background: #3b82f6; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">{{ output.typ }}</span>
                <strong style="font-size: 0.9rem;">{{ output.nazev }}</strong>
              </div>
              <p style="font-size: 0.8rem; color: #64748b; margin: 0.5rem 0;">{{ output.popis|truncatewords:15 }}</p>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <div style="font-size: 0.75rem; color: #94a3b8;">{{ output.created_at|timesince }} zpƒõt</div>
                <a href="" class="btn btn-outline" style="padding: 4px 8px; font-size: 0.75rem;">Zobrazit</a>
              </div>
            </div>
            {% endfor %}
          </div>

          <div style="margin-top: 1.5rem; text-align: center;">
            <a href="{% url 'pravo_ai' %}" class="btn btn-primary">
              Zobrazit v≈°echny AI v√Ωstupy &#8594;
            </a>
          </div>
        </div>
        {% elif not user.is_authenticated %}
        <!-- Demo AI v√Ωstupy pro nep≈ôihl√°≈°en√© u≈æivatele -->
        <div class="ai-outputs-section">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 1.5rem;">
            <div style="font-size: 1.5rem;">&#9889;</div>
            <div>
              <h2 style="font-size: 1.5rem; font-weight: 700; margin: 0;">AI Pr√°vo - Uk√°zka mo≈ænost√≠</h2>
              <p style="color: #64748b; margin: 0;">P≈ô√≠klady anal√Ωz a dokument≈Ø generovan√Ωch AI syst√©mem</p>
            </div>
          </div>
          
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
            <div class="ai-output-item">
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 0.5rem;">
                <span style="background: #3b82f6; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">Anal√Ωza smlouvy</span>
                <strong style="font-size: 0.9rem;">Kupn√≠ smlouva - rizikov√© klauzule</strong>
              </div>
              <p style="font-size: 0.8rem; color: #64748b; margin: 0.5rem 0;">AI identifikovalo 3 potenci√°ln√≠ rizika a navrhlo 5 √∫prav pro lep≈°√≠ pr√°vn√≠ ochranu.</p>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <div style="font-size: 0.75rem; color: #94a3b8;">P≈ôed 15 minutami</div>
                <span style="background: #f1f5f9; color: #64748b; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">Demo</span>
              </div>
            </div>
            
            <div class="ai-output-item">
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 0.5rem;">
                <span style="background: #059669; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">Pr√°vn√≠ precedent</span>
                <strong style="font-size: 0.9rem;">Rozsudek NSS - spr√°vn√≠ ≈ô√≠zen√≠</strong>
              </div>
              <p style="font-size: 0.8rem; color: #64748b; margin: 0.5rem 0;">Nalezen relevantn√≠ rozsudek NSS 4 Ads 45/2023 vztahuj√≠c√≠ se k problematice spr√°vn√≠ho ≈ô√≠zen√≠.</p>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <div style="font-size: 0.75rem; color: #94a3b8;">P≈ôed 1 hodinou</div>
                <span style="background: #f1f5f9; color: #64748b; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">Demo</span>
              </div>
            </div>
            
            <div class="ai-output-item">
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 0.5rem;">
                <span style="background: #dc2626; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">Generov√°n√≠ dokumentu</span>
                <strong style="font-size: 0.9rem;">≈Ωaloba - vym√°h√°n√≠ pohled√°vky</strong>
              </div>
              <p style="font-size: 0.8rem; color: #64748b; margin: 0.5rem 0;">Vygenerov√°na ≈æaloba dle ¬ß 142 OS≈ò s automatick√Ωm v√Ωpoƒçtem √∫rok≈Ø a n√°klad≈Ø ≈ô√≠zen√≠.</p>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <div style="font-size: 0.75rem; color: #94a3b8;">P≈ôed 2 hodinami</div>
                <span style="background: #f1f5f9; color: #64748b; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">Demo</span>
              </div>
            </div>
          </div>
          
          <div style="margin-top: 1.5rem; text-align: center;">
            <a href="{% url 'login_cs' %}" class="btn btn-primary">
              &#128273; P≈ôihl√°sit se pro pln√Ω p≈ô√≠stup k AI Pr√°vo &#8594;
            </a>
          </div>
        </div>
        {% endif %}

<!-- My Projects Section -->
{% if user.is_authenticated %}
<div style="margin-bottom: 3rem;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
    <div>
      <h2 style="font-size: 1.25rem; font-weight: 600; margin: 0;">Moje projekty</h2>
      <p style="color: #64748b; margin: 0; font-size: 0.875rem;">{{ user_projects|length|default:0 }} aktivn√≠ch projekt≈Ø</p>
    </div>
    <a href="{% url 'index_project_cs' %}" class="btn btn-outline" style="font-size: 0.875rem;">Zobrazit v≈°e ‚Üí</a>
  </div>

  {% if user_projects %}
  <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem;">
    {% for project in user_projects|slice:":6" %}
      {% with project=project %}
        {% include 'inc/components.html' with component='project_card' %}
      {% endwith %}
    {% endfor %}
  </div>
  {% else %}
    {% with icon="üìÅ" title="≈Ω√°dn√© projekty" message="Zaƒçnƒõte vytvo≈ôen√≠m nov√©ho projektu" action_url="new_project_cs" action_label="Nov√Ω projekt" %}
      {% include 'inc/components.html' with component='empty_state' %}
    {% endwith %}
  {% endif %}
</div>

<!-- My Tasks Section -->
<div class="content-card" style="margin-bottom: 3rem;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
    <div>
      <h3 style="font-size: 1.125rem; font-weight: 600; margin: 0;">P≈ôi≈ôazen√© √∫koly</h3>
      <p style="color: #64748b; margin: 0; font-size: 0.875rem;">{{ user_tasks|length|default:0 }} ƒçekaj√≠c√≠ch √∫kol≈Ø</p>
    </div>
    <a href="{% url 'task_management' %}" class="btn btn-outline" style="font-size: 0.875rem;">Zobrazit v≈°e ‚Üí</a>
  </div>

  {% if user_tasks %}
  <div style="display: flex; flex-direction: column; gap: 0.75rem;">
    {% for task in user_tasks|slice:":5" %}
      {% with task=task inline_actions=False %}
        {% include 'inc/components.html' with component='task_item' %}
      {% endwith %}
    {% endfor %}
  </div>
  {% else %}
    {% with icon="‚úì" title="≈Ω√°dn√© √∫koly" message="Nem√°te p≈ôi≈ôazen√© ≈æ√°dn√© √∫koly" %}
      {% include 'inc/components.html' with component='empty_state' %}
    {% endwith %}
  {% endif %}
</div>
{% endif %}

<!-- Landing Page for Unauthenticated Users -->
{% if not user.is_authenticated %}
<!-- Stats Grid for Landing -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;">
  {% with value="1,247" label="Aktivn√≠ projekty" icon="üìÅ" color="blue" sublabel="v syst√©mu" %}
    {% include 'inc/components.html' with component='stat_card' %}
  {% endwith %}

  {% with value="15,632" label="AI dotazy" icon="‚ö°" color="purple" sublabel="vy≈ôe≈°eno" %}
    {% include 'inc/components.html' with component='stat_card' %}
  {% endwith %}

  {% with value="3,456" label="Organizace" icon="üè¢" color="green" sublabel="vyu≈æ√≠v√° FDK" %}
    {% include 'inc/components.html' with component='stat_card' %}
  {% endwith %}

  {% with value="892" label="U≈æivatel√©" icon="üë•" color="orange" sublabel="registrovan√Ωch" %}
    {% include 'inc/components.html' with component='stat_card' %}
  {% endwith %}
</div>

<!-- Call to Action -->
<div class="content-card" style="text-align: center; margin-bottom: 3rem; padding: 3rem 2rem;">
  <div style="font-size: 3rem; margin-bottom: 1rem;">üöÄ</div>
  <h2 style="margin-bottom: 1rem; color: #1e293b; font-size: 1.75rem; font-weight: 600;">P≈ôipojte se k FDK.cz</h2>
  <p style="color: #64748b; margin-bottom: 2rem; max-width: 600px; margin-left: auto; margin-right: auto;">
    Z√≠skejte p≈ô√≠stup k pokroƒçil√Ωm AI n√°stroj≈Øm pro pr√°vn√≠ anal√Ωzy, komplexn√≠mu projektov√©mu managementu
    a v≈°em funkc√≠m pro efektivn√≠ ≈ô√≠zen√≠ va≈°√≠ organizace.
  </p>
  <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
    <a href="{% url 'registration_cs' %}" class="btn btn-primary">
      üìù Zaregistrovat se
    </a>
    <a href="{% url 'login_cs' %}" class="btn btn-outline">
      üîê P≈ôihl√°sit se
    </a>
  </div>
</div>

<!-- Features Grid -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;">
  <div class="content-card" style="text-align: center; padding: 2rem;">
    <div style="font-size: 2.5rem; margin-bottom: 1rem;">‚ö°</div>
    <h3 style="margin-bottom: 0.75rem; color: #1e293b; font-size: 1.125rem; font-weight: 600;">AI Pr√°vn√≠ n√°stroje</h3>
    <p style="color: #64748b; font-size: 0.875rem; line-height: 1.6;">
      Pokroƒçil√© AI pro anal√Ωzu smluv, hled√°n√≠ precedent≈Ø a generov√°n√≠ pr√°vn√≠ch dokument≈Ø
    </p>
  </div>

  <div class="content-card" style="text-align: center; padding: 2rem;">
    <div style="font-size: 2.5rem; margin-bottom: 1rem;">üìä</div>
    <h3 style="margin-bottom: 0.75rem; color: #1e293b; font-size: 1.125rem; font-weight: 600;">Projektov√Ω management</h3>
    <p style="color: #64748b; font-size: 0.875rem; line-height: 1.6;">
      Komplexn√≠ ≈ô√≠zen√≠ projekt≈Ø s √∫koly, deadliny a sledov√°n√≠m pokroku
    </p>
  </div>

  <div class="content-card" style="text-align: center; padding: 2rem;">
    <div style="font-size: 2.5rem; margin-bottom: 1rem;">üí∞</div>
    <h3 style="margin-bottom: 0.75rem; color: #1e293b; font-size: 1.125rem; font-weight: 600;">√öƒçetnictv√≠ a finance</h3>
    <p style="color: #64748b; font-size: 0.875rem; line-height: 1.6;">
      Spr√°va financ√≠, fakturace a kompletn√≠ √∫ƒçetn√≠ evidence
    </p>
  </div>

  <div class="content-card" style="text-align: center; padding: 2rem;">
    <div style="font-size: 2.5rem; margin-bottom: 1rem;">üë•</div>
    <h3 style="margin-bottom: 0.75rem; color: #1e293b; font-size: 1.125rem; font-weight: 600;">Spr√°va kontakt≈Ø</h3>
    <p style="color: #64748b; font-size: 0.875rem; line-height: 1.6;">
      CRM syst√©m pro spr√°vu klient≈Ø a obchodn√≠ch partner≈Ø
    </p>
  </div>

  <div class="content-card" style="text-align: center; padding: 2rem;">
    <div style="font-size: 2.5rem; margin-bottom: 1rem;">üìÑ</div>
    <h3 style="margin-bottom: 0.75rem; color: #1e293b; font-size: 1.125rem; font-weight: 600;">Spr√°va smluv</h3>
    <p style="color: #64748b; font-size: 0.875rem; line-height: 1.6;">
      Sledov√°n√≠ smluv, automatick√© upom√≠nky a evidence dokument≈Ø
    </p>
  </div>

  <div class="content-card" style="text-align: center; padding: 2rem;">
    <div style="font-size: 2.5rem; margin-bottom: 1rem;">üì¶</div>
    <h3 style="margin-bottom: 0.75rem; color: #1e293b; font-size: 1.125rem; font-weight: 600;">Skladov√© hospod√°≈ôstv√≠</h3>
    <p style="color: #64748b; font-size: 0.875rem; line-height: 1.6;">
      Kompletn√≠ spr√°va skladov√Ωch z√°sob a inventury
    </p>
  </div>
</div>
{% endif %}
{% endblock %}