{% extends "base.html" %}
{% load i18n %}

{% block title %}Upravit dokument | FDK.cz{% endblock %}
{% block header_title %}Upravit dokument{% endblock %}
{% block header_subtitle %}Upravte n치zev, typ, kategorii a obsah dokumentu projektu <strong>{{ document.project.name }}</strong>{% endblock %}

{% block meta %}
<!-- Summernote knihovny -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>
{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
  <div class="content-card">
    <form method="POST" enctype="multipart/form-data">
      {% csrf_token %}
      {{ form.non_field_errors }}

      <!-- N치zev -->
      <div class="form-group mb-4">
        <label for="id_title" class="block text-sm font-medium text-gray-700">N치zev dokumentu <span class="text-red-600">*</span></label>
        <input type="text" id="id_title" name="title" required
               value="{{ form.title.value|default:document.title }}"
               class="w-full p-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500">
        {% if form.title.errors %}
          <p class="text-red-600 text-sm mt-1">{{ form.title.errors|join:", " }}</p>
        {% endif %}
      </div>

      <!-- Typ -->
      <div class="form-group mb-4">
        <label for="id_document_type" class="block text-sm font-medium text-gray-700">Typ dokumentu <span class="text-red-600">*</span></label>
        <input type="text" id="id_document_type" name="document_type" required
               value="{{ form.document_type.value|default:document.document_type }}"
               class="w-full p-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500">
        {% if form.document_type.errors %}
          <p class="text-red-600 text-sm mt-1">{{ form.document_type.errors|join:", " }}</p>
        {% endif %}
      </div>

      <!-- Kategorie -->
      <div class="form-group mb-4">
        <label for="id_category" class="block text-sm font-medium text-gray-700">Kategorie</label>
        <select id="id_category" name="category"
                class="w-full p-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500">
          {% for category in form.category.field.queryset %}
          <option value="{{ category.pk }}"
            {% if form.category.value == category.pk or document.category.id == category.pk %}selected{% endif %}>
            {{ category.name }}
          </option>
          {% endfor %}
        </select>
      </div>

      <!-- Obsah (Summernote) -->
      <div class="form-group mb-4">
        <label for="id_description" class="block text-sm font-medium text-gray-700">Obsah</label>
        <textarea id="id_description" name="description" rows="6"
                  class="w-full border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500">{{ form.description.value|default:document.description }}</textarea>
      </div>

      <!-- Akce -->
      <div class="flex justify-end gap-3 pt-4 border-t border-gray-200">
        <a href="{% url 'detail_project' document.project.project_id %}" class="btn btn-outline">Zru코it</a>
        <button type="submit" class="btn btn-primary">游 Ulo쬴t zm캩ny</button>
      </div>
    </form>
  </div>
</div>

<!-- Inicializace Summernote -->
<script>
$(document).ready(function() {
  $('#id_description').summernote({
    placeholder: 'Obsah dokumentu',
    tabsize: 2,
    height: 240,
    toolbar: [
      ['style', ['bold', 'italic', 'underline', 'clear']],
      ['para', ['ul', 'ol', 'paragraph']],
      ['insert', ['link', 'table']],
      ['view', ['fullscreen', 'codeview']]
    ]
  });
});
</script>
{% endblock %}
