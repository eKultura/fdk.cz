{% extends "base.html" %}
{% load i18n %}

{% block title %}Upravit 칰kol | FDK.cz{% endblock %}
{% block header_title %}Upravit 칰kol{% endblock %}
{% block header_subtitle %}Upravte detaily 칰kolu v projektu <strong>{{ project.name }}</strong>{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
  <div class="content-card">
    <form method="POST">
      {% csrf_token %}

      <!-- N치zev -->
      <div class="form-group mb-4">
        <label for="id_title" class="block text-sm font-medium text-gray-700">N치zev 칰kolu <span class="text-red-600">*</span></label>
        <input type="text" id="id_title" name="title" required
               value="{{ form.title.value|default:task.title }}"
               class="w-full p-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500">
        {% if form.title.errors %}
          <p class="text-red-600 text-sm mt-1">{{ form.title.errors|join:", " }}</p>
        {% endif %}
      </div>

      <!-- Popis -->
      <div class="form-group mb-4">
        <label for="id_description" class="block text-sm font-medium text-gray-700">Popis</label>
        <textarea id="id_description" name="description" rows="4"
                  class="w-full p-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500">{{ form.description.value|default:task.description }}</textarea>
      </div>

      <!-- Status -->
      <div class="form-group mb-4">
        <label for="id_status" class="block text-sm font-medium text-gray-700">Stav</label>
        <select id="id_status" name="status"
                class="w-full p-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500">
          <option value="Nezah치jeno" {% if task.status == "Nezah치jeno" %}selected{% endif %}>Nezah치jeno</option>
          <option value="Prob칤h치" {% if task.status == "Prob칤h치" %}selected{% endif %}>Prob칤h치</option>
          <option value="Hotovo" {% if task.status == "Hotovo" %}selected{% endif %}>Hotovo</option>
        </select>
      </div>

      <!-- Kategorie -->
      <div class="form-group mb-4">
        <label for="id_category" class="block text-sm font-medium text-gray-700">Kategorie</label>
        <select id="id_category" name="category"
                class="w-full p-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500">
          {% for category in form.category.field.queryset %}
          <option value="{{ category.pk }}"
            {% if task.category and category.pk == task.category.pk %}selected{% endif %}>
            {{ category.name }}
          </option>
          {% endfor %}
        </select>
      </div>

      <!-- Priorita -->
      <div class="form-group mb-4">
        <label for="id_priority" class="block text-sm font-medium text-gray-700">Priorita</label>
        <select id="id_priority" name="priority"
                class="w-full p-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500">
          <option value="N칤zk치" {% if task.priority == "N칤zk치" %}selected{% endif %}>N칤zk치</option>
          <option value="St콏edn칤" {% if task.priority == "St콏edn칤" %}selected{% endif %}>St콏edn칤</option>
          <option value="Vysok치" {% if task.priority == "Vysok치" %}selected{% endif %}>Vysok치</option>
          <option value="Nice to have" {% if task.priority == "Nice to have" %}selected{% endif %}>Nice to have</option>
        </select>
      </div>

      <!-- P콏id캩leno -->
      <div class="form-group mb-4">
        <label for="id_assigned" class="block text-sm font-medium text-gray-700">P콏id캩leno</label>
        <select id="id_assigned" name="assigned"
                class="w-full p-2 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500">
          {% for member in project.project_users.all %}
          <option value="{{ member.user.id }}"
            {% if task.assigned and member.user.id == task.assigned.id %}selected{% endif %}>
            {{ member.user.username }}
          </option>
          {% endfor %}
        </select>
      </div>

      <!-- Tla캜칤tka -->
      <div class="flex justify-end gap-3 pt-4 border-t border-gray-200">
        <a href="{% url 'detail_project' project.project_id %}" class="btn btn-outline">Zru코it</a>
        <button type="submit" class="btn btn-primary">游 Ulo쬴t zm캩ny</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
