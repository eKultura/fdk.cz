{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Projekty | FDK.cz" %}{% endblock %}
{% block header_title %}{% trans "Projekty" %}{% endblock %}
{% block header_subtitle %}{% trans "Spravujte svÃ© projekty pÅ™ehlednÄ› a efektivnÄ›" %}{% endblock %}

{% block context_breadcrumbs %}
  <span class="breadcrumb-link" style="font-weight: 600; color: #1e293b;">{% trans "Projekty" %}</span>
{% endblock %}

{% block content %}

<!-- Quick Actions Bar -->
<div style="display: flex; gap: 0.75rem; margin-bottom: 2rem; flex-wrap: wrap;">
  {% with url="new_project_cs" icon="ğŸ“" label="NovÃ½ projekt" %}
    {% include 'inc/components.html' with component='quick_action' %}
  {% endwith %}

  {% with url="task_management" icon="âœ“" label="SprÃ¡va ÃºkolÅ¯" %}
    {% include 'inc/components.html' with component='quick_action' %}
  {% endwith %}

  {% with url="gantt_chart" icon="ğŸ“Š" label="Gantt diagram" %}
    {% include 'inc/components.html' with component='quick_action' %}
  {% endwith %}
</div>

<!-- Active Projects -->
<div style="margin-bottom: 3rem;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
    <div>
      <h2 style="font-size: 1.25rem; font-weight: 600; margin: 0;">{% trans "AktivnÃ­ projekty" %}</h2>
      <p style="color: #64748b; margin: 0; font-size: 0.875rem;">{{ user_projects|length|default:0 }} {% if user_projects|length == 1 %}projekt{% elif user_projects|length < 5 %}projekty{% else %}projektÅ¯{% endif %}</p>
    </div>
    <a href="{% url 'new_project_cs' %}" class="btn btn-primary">
      â• {% trans "NovÃ½ projekt" %}
    </a>
  </div>

  {% if user_projects %}
  <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem;">
    {% for project in user_projects %}
      {% with project=project %}
        {% include 'inc/components.html' with component='project_card' %}
      {% endwith %}
    {% endfor %}
  </div>
  {% else %}
    {% with icon="ğŸ“" title="Å½Ã¡dnÃ© projekty" message="ZaÄnÄ›te vytvoÅ™enÃ­m novÃ©ho projektu" action_url="new_project_cs" action_label="NovÃ½ projekt" %}
      {% include 'inc/components.html' with component='empty_state' %}
    {% endwith %}
  {% endif %}
</div>

<!-- Archived Projects -->
{% if archived_projects %}
<div class="content-card" style="border: 2px solid #e5e7eb; background: linear-gradient(to bottom, #f9fafb, #ffffff);">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
    <div>
      <h3 style="font-size: 1.125rem; font-weight: 600; margin: 0; color: #6b7280;">ğŸ“¦ {% trans "Archiv projektÅ¯" %}</h3>
      <p style="color: #9ca3af; margin: 0; font-size: 0.875rem;">
        {{ archived_projects|length }} {% if archived_projects|length == 1 %}projekt{% elif archived_projects|length < 5 %}projekty{% else %}projektÅ¯{% endif %}
      </p>
    </div>
  </div>

  <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem;">
    {% for project in archived_projects %}
    <a href="{% url 'detail_project' project.project_id %}" class="project-card" style="opacity: 0.75; filter: grayscale(20%);">
      <div class="project-card-header">
        <h3 class="project-card-title" style="color: #6b7280;">{{ project.name|safe }}</h3>
        {% if project.organization %}
          <span class="badge badge-org" style="background: #f3f4f6; color: #6b7280;">ğŸ¢ {{ project.organization.name }}</span>
        {% else %}
          <span class="badge" style="background: #fef3c7; color: #92400e; border-radius: 12px; font-size: 0.75rem; font-weight: 500;">ğŸ‘¤ OsobnÃ­</span>
        {% endif %}
      </div>

      {% if project.description %}
      <p class="project-card-description" style="color: #9ca3af;">{{ project.description|truncatewords:15|safe }}</p>
      {% endif %}

      <div class="project-card-stats">
        {% if project.owner %}
        <div class="project-stat">
          <span class="project-stat-icon">ğŸ‘¤</span>
          <span class="project-stat-label">{{ project.owner.get_full_name|default:project.owner.username|truncatewords:2 }}</span>
        </div>
        {% endif %}

        {% if project.end_date %}
        <div class="project-stat">
          <span class="project-stat-icon">ğŸ</span>
          <span class="project-stat-label">{{ project.end_date|date:"d.m.Y" }}</span>
        </div>
        {% endif %}
      </div>
    </a>
    {% endfor %}
  </div>
</div>
{% endif %}

{% endblock %}
