{% extends "base.html" %}
{% load i18n %}

{% block title %}Nov√Ω dokument | FDK.cz{% endblock %}
{% block header_title %}Nov√Ω dokument{% endblock %}
{% block header_subtitle %}Zalo≈æen√≠ nov√©ho dokumentu v projektu{% endblock %}

{% block meta %}
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>
{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto mt-8">
  <div class="content-card">
    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}
      {{ form.non_field_errors }}

      <h2 class="text-xl font-semibold text-gray-800 mb-4">Z√°kladn√≠ informace</h2>

      <!-- N√°zev -->
      <div class="form-group mb-4">
        <label for="id_title" class="block font-medium text-gray-700">N√°zev dokumentu <span class="text-red-600">*</span></label>
        <input type="text" name="title" id="id_title" required
               value="{{ form.title.value|default_if_none:'' }}"
               placeholder="Zadejte n√°zev dokumentu"
               class="form-input w-full border border-gray-300 rounded-lg p-2">
        {% if form.title.errors %}
          <p class="text-red-600 text-sm mt-1">{{ form.title.errors|join:", " }}</p>
        {% endif %}
      </div>

      <!-- Typ -->
      <div class="form-group mb-4">
        <label for="id_document_type" class="block font-medium text-gray-700">Typ dokumentu <span class="text-red-600">*</span></label>
        <input type="text" name="document_type" id="id_document_type"
               value="{{ form.document_type.value|default_if_none:'' }}"
               placeholder="Nap≈ô. z√°pis, smlouva, p≈ô√≠loha‚Ä¶"
               class="form-input w-full border border-gray-300 rounded-lg p-2">
      </div>

      <!-- Kategorie -->
      <div class="form-group mb-4">
        <label for="id_category" class="block font-medium text-gray-700">Kategorie</label>
        <select name="category" id="id_category" class="form-input w-full border border-gray-300 rounded-lg p-2">
          <option value="">-- Vyberte kategorii --</option>
          {% for category in form.category.field.queryset %}
            <option value="{{ category.pk }}"
                    {% if form.category.value == category.pk %}selected{% endif %}>
              {{ category.name }}
            </option>
          {% endfor %}
        </select>
      </div>

      <!-- Obsah -->
      <div class="form-group mb-6">
        <label for="id_description" class="block font-medium text-gray-700">Obsah dokumentu</label>
        <textarea name="description" id="id_description"
                  class="form-input w-full border border-gray-300 rounded-lg p-2"
                  placeholder="Zadejte obsah dokumentu">{{ form.description.value|default_if_none:'' }}</textarea>
      </div>

      <!-- Akce -->
      <div class="flex flex-col sm:flex-row gap-3 mt-6">
        <button type="submit" class="btn btn-primary w-full sm:w-auto">
          üìÑ Ulo≈æit dokument
        </button>
        <a href="{% url 'detail_project' project.project_id %}" class="btn btn-outline w-full sm:w-auto">
          ‚Üê Zpƒõt
        </a>
      </div>
    </form>
  </div>
</div>

<!-- Inicializace Summernote -->
<script>
  $(document).ready(function() {
    $('#id_description').summernote({
      placeholder: 'Zadejte obsah dokumentu...',
      tabsize: 2,
      height: 250,
      toolbar: [
        ['style', ['bold', 'italic', 'underline', 'clear']],
        ['font', ['fontsize', 'color']],
        ['para', ['ul', 'ol', 'paragraph']],
        ['insert', ['link', 'table']],
        ['view', ['fullscreen']]
      ]
    });
  });
</script>
{% endblock %}
