{% comment %}
Centr치ln칤 sidebar menu pro cel칳 FDK.cz syst칠m
- Aktivn칤 modul s podmenu je naho콏e pod Hlavn칤
- Kategorie jsou fixn칤 - jen odkazy bez podmenu
{% endcomment %}

<!-- Hlavn칤 Section -->
<div class="nav-section">
  <div class="nav-section-title">Hlavn칤</div>
  <a href="{% url 'index' %}" class="nav-item {% if request.resolver_match.url_name == 'index' %}active{% endif %}">
    <span class="nav-icon">&#127968;</span> Dom콢
  </a>
  {% if user.is_authenticated %}
  <a href="{% url 'organization_dashboard' %}" class="nav-item">
    <span class="nav-icon">&#127970;</span> Moje organizace
  </a>

  {% comment %} Aktu치ln칤 kontext - organizace nebo osobn칤 {% endcomment %}
  {% if current_organization %}
  <div style="margin: 0.5rem 0; padding: 0.75rem; background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-radius: 8px; border-left: 3px solid #3b82f6;">
    <div style="font-size: 0.75rem; color: #1e40af; font-weight: 600; margin-bottom: 0.25rem;">
      游끽 AKTIVN칈 ORGANIZACE
    </div>
    <div style="font-size: 0.875rem; font-weight: 600; color: #1e293b; margin-bottom: 0.5rem;">
      {{ current_organization.name }}
    </div>
    {% if can_switch_organizations %}
    <a href="{% url 'organization_dashboard' %}" style="font-size: 0.75rem; color: #3b82f6; text-decoration: underline;">
      P콏epnout organizaci
    </a>
    {% endif %}
  </div>
  {% elif user_organizations %}
  <div style="margin: 0.5rem 0; padding: 0.75rem; background: #f1f5f9; border-radius: 8px; border-left: 3px solid #94a3b8;">
    <div style="font-size: 0.75rem; color: #64748b; font-weight: 600; margin-bottom: 0.25rem;">
      游녻 OSOBN칈 KONTEXT
    </div>
    <a href="{% url 'organization_dashboard' %}" style="font-size: 0.75rem; color: #3b82f6; text-decoration: underline;">
      P콏epnout na organizaci
    </a>
  </div>
  {% endif %}
  {% endif %}
</div>

{% if user.is_authenticated %}

{% comment %} AKTIVN칈 MODUL - zobraz칤 se naho콏e s podmenu {% endcomment %}
{% if active_module %}
<div class="nav-section nav-section-active">
  <div class="nav-section-title">Aktivn칤</div>
  {% if active_module == 'project_management' %}
    {% include 'inc/menus/project_menu.html' %}
  {% elif active_module == 'task_management' %}
    {% include 'inc/menus/task_menu.html' %}
  {% elif active_module == 'test_management' %}
    {% include 'inc/menus/test_menu.html' %}
  {% elif active_module == 'b2b_management' %}
    {% include 'inc/menus/b2b_menu.html' %}
  {% elif active_module == 'hr_management' %}
    {% include 'inc/menus/hr_menu.html' %}
  {% elif active_module == 'risk_management' %}
    {% include 'inc/menus/risk_menu.html' %}
  {% elif active_module == 'it_management' %}
    {% include 'inc/menus/it_menu.html' %}
  {% elif active_module == 'asset_management' %}
    {% include 'inc/menus/asset_menu.html' %}
  {% elif active_module == 'accounting' %}
    {% include 'inc/menus/accounting_menu.html' %}
  {% elif active_module == 'grants' %}
    {% include 'inc/menus/grants_menu.html' %}
  {% elif active_module == 'contacts' %}
    {% include 'inc/menus/contacts_menu.html' %}
  {% elif active_module == 'contracts' %}
    {% include 'inc/menus/contracts_menu.html' %}
  {% elif active_module == 'lists' %}
    {% include 'inc/menus/lists_menu.html' %}
  {% elif active_module == 'warehouse' %}
    {% include 'inc/menus/warehouse_menu.html' %}
  {% elif active_module == 'law_ai' %}
    {% include 'inc/menus/law_menu.html' %}
  {% elif active_module == 'dms' %}
    {% include 'inc/menus/dms_menu.html' %}
  {% endif %}
</div>
{% endif %}

{% comment %} KATEGORIE: Management {% endcomment %}
<div class="nav-section">
  <div class="nav-section-title">Management</div>
  {% for module in visible_modules %}
    {% if module.name == 'project_management' %}
      <a href="{% url 'index_project_cs' %}" class="nav-item"><span class="nav-icon">&#128295;</span> Spr치va projekt콢</a>
    {% elif module.name == 'task_management' %}
      <a href="{% url 'task_management' %}" class="nav-item"><span class="nav-icon">&#10004;</span> Spr치va 칰kol콢</a>
    {% elif module.name == 'test_management' %}
      <a href="{% url 'list_tests' %}" class="nav-item"><span class="nav-icon">&#129514;</span> Testov치n칤</a>
    {% elif module.name == 'b2b_management' %}
      <a href="{% url 'b2b_dashboard' %}" class="nav-item"><span class="nav-icon">&#129309;</span> Spr치va B2B</a>
    {% elif module.name == 'hr_management' %}
      <a href="{% url 'hr_dashboard' %}" class="nav-item"><span class="nav-icon">&#128188;</span> HR Management</a>
    {% elif module.name == 'risk_management' %}
      <a href="{% url 'risk_dashboard' %}" class="nav-item"><span class="nav-icon">&#9888;</span> Spr치va rizik</a>
    {% elif module.name == 'it_management' %}
      <a href="{% url 'it_dashboard' %}" class="nav-item"><span class="nav-icon">&#128187;</span> Spr치va IT</a>
    {% elif module.name == 'asset_management' %}
      <a href="{% url 'asset_dashboard' %}" class="nav-item"><span class="nav-icon">&#128203;</span> Spr치va majetku</a>
    {% endif %}
  {% endfor %}
</div>

{% comment %} KATEGORIE: Finance - zobraz칤 se jen kdy m치 n캩jak칠 moduly {% endcomment %}
{% if category_visibility.Finance %}
<div class="nav-section">
  <div class="nav-section-title">Finance</div>
  {% for module in visible_modules %}
    {% if module.name == 'accounting' %}
      <a href="{% url 'accounting_dashboard' %}" class="nav-item"><span class="nav-icon">&#128202;</span> 칔캜etnictv칤</a>
    {% elif module.name == 'grants' %}
      <a href="{% url 'grant_list' %}" class="nav-item"><span class="nav-icon">&#128176;</span> Granty &amp; Dotace</a>
    {% endif %}
  {% endfor %}
  <a href="{% url 'user_settings' %}" class="nav-item" style="color: #94a3b8; font-size: 0.875rem;">
    <span class="nav-icon">&#128161;</span> Zapnout dal코칤 moduly v nastaven칤
  </a>
</div>
{% endif %}

{% comment %} KATEGORIE: Business - zobraz칤 se jen kdy m치 n캩jak칠 moduly {% endcomment %}
{% if category_visibility.Business %}
<div class="nav-section">
  <div class="nav-section-title">Business</div>
  {% for module in visible_modules %}
    {% if module.name == 'contacts' %}
      <a href="{% url 'my_contacts' %}" class="nav-item"><span class="nav-icon">&#128100;</span> Kontakty</a>
    {% elif module.name == 'contracts' %}
      <a href="{% url 'list_contracts' %}" class="nav-item"><span class="nav-icon">&#128196;</span> Smlouvy</a>
    {% endif %}
  {% endfor %}
  <a href="{% url 'user_settings' %}" class="nav-item" style="color: #94a3b8; font-size: 0.875rem;">
    <span class="nav-icon">&#128161;</span> Zapnout dal코칤 moduly v nastaven칤
  </a>
</div>
{% endif %}

{% comment %} KATEGORIE: N치stroje {% endcomment %}
<div class="nav-section">
  <div class="nav-section-title">N치stroje</div>
  {% for module in visible_modules %}
    {% if module.name == 'lists' %}
      <a href="{% url 'index_list' %}" class="nav-item"><span class="nav-icon">&#128221;</span> Seznamy</a>
    {% elif module.name == 'warehouse' %}
      <a href="{% url 'all_stores' %}" class="nav-item"><span class="nav-icon">&#128230;</span> Sklad</a>
    {% elif module.name == 'law_ai' %}
      <a href="{% url 'pravo_ai' %}" class="nav-item"><span class="nav-icon">&#9889;</span> AI Pr치vn칤k</a>
    {% endif %}
  {% endfor %}
  <a href="{% url 'dms_dashboard' %}" class="nav-item"><span class="nav-icon">&#128193;</span> DMS</a>
</div>

<!-- Nastaven칤 Section -->
<div class="nav-section">
  <div class="nav-section-title">Nastaven칤</div>
  <a href="{% url 'user_settings' %}" class="nav-item"><span class="nav-icon">&#9881;</span> Nastaven칤 칰캜tu</a>
  <a href="{% url 'user_settings' %}" class="nav-item"><span class="nav-icon">&#10133;</span> Zapnout moduly</a>
</div>

{% if user.is_superuser or user.is_staff %}
<div class="nav-section">
  <div class="nav-section-title">Administrace</div>
  <a href="{% url 'admin_modules' %}" class="nav-item"><span class="nav-icon">&#128176;</span> Spr치va modul콢</a>
  <a href="{% url 'admin_subscriptions' %}" class="nav-item"><span class="nav-icon">&#128196;</span> P콏edplatn치</a>
  <a href="{% url 'admin_assign_module' %}" class="nav-item"><span class="nav-icon">&#10133;</span> P콏i콏adit modul</a>
</div>
{% endif %}

{% else %}
<!-- Menu pro nep콏ihl치코en칠 u쬴vatele -->
<div class="nav-section">
  <div class="nav-section-title">Obl칤ben칠 moduly</div>
  <a href="{% url 'module_project_management' %}" class="nav-item" title="Zjistit v칤ce o spr치v캩 projekt콢">
    <span class="nav-icon">&#128295;</span> Spr치va projekt콢
  </a>
  <a href="{% url 'module_grants' %}" class="nav-item" title="Zjistit v칤ce o grantech a dotac칤ch">
    <span class="nav-icon">&#128176;</span> Granty a dotace
  </a>
  <a href="{% url 'module_accounting' %}" class="nav-item" title="Zjistit v칤ce o 칰캜etnictv칤">
    <span class="nav-icon">&#128202;</span> 칔캜etnictv칤
  </a>
  <a href="{% url 'module_law_ai' %}" class="nav-item" title="Zjistit v칤ce o AI Pr치vn칤kovi">
    <span class="nav-icon">&#9889;</span> AI Pr치vn칤k
  </a>
  <a href="{% url 'dms_public' %}" class="nav-item" title="Zjistit v칤ce o DMS">
    <span class="nav-icon">&#128193;</span> DMS
  </a>
</div>

<div class="nav-section">
  <div class="nav-section-title">칔캜et</div>
  <a href="{% url 'login_cs' %}" class="nav-item">
    <span class="nav-icon">&#128273;</span> P콏ihl치sit se
  </a>
  <a href="{% url 'registration_cs' %}" class="nav-item">
    <span class="nav-icon">&#128221;</span> Registrace
  </a>
</div>
{% endif %}
