{% comment %}
Centrální sidebar menu pro celý FDK.cz systém
- Aktivní modul s podmenu je nahoře pod Hlavní
- Kategorie jsou fixní - jen odkazy bez podmenu
{% endcomment %}

<!-- Hlavní Section -->
<div class="nav-section">
  <div class="nav-section-title">Hlavní</div>
  <a href="{% url 'index' %}" class="nav-item {% if request.resolver_match.url_name == 'index' %}active{% endif %}">
    <span class="nav-icon">&#127968;</span> Domů
  </a>
  {% if user.is_authenticated %}
  <a href="{% url 'organization_dashboard' %}" class="nav-item">
    <span class="nav-icon">&#127970;</span> Moje organizace
  </a>
  {% endif %}
</div>

{% if user.is_authenticated %}

{% comment %} AKTIVNÍ MODUL - zobrazí se nahoře s podmenu {% endcomment %}
{% if active_module %}
<div class="nav-section nav-section-active">
  <div class="nav-section-title">Aktivní</div>
  {% if active_module == 'project_management' %}
    {% include 'inc/menus/project_menu.html' %}
  {% elif active_module == 'task_management' %}
    {% include 'inc/menus/task_menu.html' %}
  {% elif active_module == 'test_management' %}
    {% include 'inc/menus/test_menu.html' %}
  {% elif active_module == 'b2b_management' %}
    {% include 'inc/menus/b2b_menu.html' %}
  {% elif active_module == 'hr_management' %}
    {% include 'inc/menus/hr_menu.html' %}
  {% elif active_module == 'risk_management' %}
    {% include 'inc/menus/risk_menu.html' %}
  {% elif active_module == 'it_management' %}
    {% include 'inc/menus/it_menu.html' %}
  {% elif active_module == 'asset_management' %}
    {% include 'inc/menus/asset_menu.html' %}
  {% elif active_module == 'accounting' %}
    {% include 'inc/menus/accounting_menu.html' %}
  {% elif active_module == 'grants' %}
    {% include 'inc/menus/grants_menu.html' %}
  {% elif active_module == 'contacts' %}
    {% include 'inc/menus/contacts_menu.html' %}
  {% elif active_module == 'contracts' %}
    {% include 'inc/menus/contracts_menu.html' %}
  {% elif active_module == 'lists' %}
    {% include 'inc/menus/lists_menu.html' %}
  {% elif active_module == 'warehouse' %}
    {% include 'inc/menus/warehouse_menu.html' %}
  {% elif active_module == 'law_ai' %}
    {% include 'inc/menus/law_menu.html' %}
  {% elif active_module == 'dms' %}
    {% include 'inc/menus/dms_menu.html' %}
  {% endif %}
</div>
{% endif %}

{% comment %} KATEGORIE: Management {% endcomment %}
<div class="nav-section">
  <div class="nav-section-title">Management</div>
  {% for module in visible_modules %}
    {% if module.name == 'project_management' %}
      <a href="{% url 'index_project_cs' %}" class="nav-item"><span class="nav-icon">&#128295;</span> Správa projektů</a>
    {% elif module.name == 'task_management' %}
      <a href="{% url 'task_management' %}" class="nav-item"><span class="nav-icon">&#10004;</span> Správa úkolů</a>
    {% elif module.name == 'test_management' %}
      <a href="{% url 'list_tests' %}" class="nav-item"><span class="nav-icon">&#129514;</span> Testování</a>
    {% elif module.name == 'b2b_management' %}
      <a href="{% url 'b2b_dashboard' %}" class="nav-item"><span class="nav-icon">&#129309;</span> Správa B2B</a>
    {% elif module.name == 'hr_management' %}
      <a href="{% url 'hr_dashboard' %}" class="nav-item"><span class="nav-icon">&#128188;</span> HR Management</a>
    {% elif module.name == 'risk_management' %}
      <a href="{% url 'risk_dashboard' %}" class="nav-item"><span class="nav-icon">&#9888;</span> Správa rizik</a>
    {% elif module.name == 'it_management' %}
      <a href="{% url 'it_dashboard' %}" class="nav-item"><span class="nav-icon">&#128187;</span> Správa IT</a>
    {% elif module.name == 'asset_management' %}
      <a href="{% url 'asset_dashboard' %}" class="nav-item"><span class="nav-icon">&#128203;</span> Správa majetku</a>
    {% endif %}
  {% endfor %}
</div>

{% comment %} KATEGORIE: Finance - zobrazí se jen když má nějaké moduly {% endcomment %}
{% if category_visibility.Finance %}
<div class="nav-section">
  <div class="nav-section-title">Finance</div>
  {% for module in visible_modules %}
    {% if module.name == 'accounting' %}
      <a href="{% url 'accounting_dashboard' %}" class="nav-item"><span class="nav-icon">&#128202;</span> Účetnictví</a>
    {% elif module.name == 'grants' %}
      <a href="{% url 'grant_list' %}" class="nav-item"><span class="nav-icon">&#128176;</span> Granty &amp; Dotace</a>
    {% endif %}
  {% endfor %}
  <a href="{% url 'user_settings' %}" class="nav-item" style="color: #94a3b8; font-size: 0.875rem;">
    <span class="nav-icon">&#128161;</span> Zapnout další moduly v nastavení
  </a>
</div>
{% endif %}

{% comment %} KATEGORIE: Business - zobrazí se jen když má nějaké moduly {% endcomment %}
{% if category_visibility.Business %}
<div class="nav-section">
  <div class="nav-section-title">Business</div>
  {% for module in visible_modules %}
    {% if module.name == 'contacts' %}
      <a href="{% url 'my_contacts' %}" class="nav-item"><span class="nav-icon">&#128100;</span> Kontakty</a>
    {% elif module.name == 'contracts' %}
      <a href="{% url 'list_contracts' %}" class="nav-item"><span class="nav-icon">&#128196;</span> Smlouvy</a>
    {% endif %}
  {% endfor %}
  <a href="{% url 'user_settings' %}" class="nav-item" style="color: #94a3b8; font-size: 0.875rem;">
    <span class="nav-icon">&#128161;</span> Zapnout další moduly v nastavení
  </a>
</div>
{% endif %}

{% comment %} KATEGORIE: Nástroje {% endcomment %}
<div class="nav-section">
  <div class="nav-section-title">Nástroje</div>
  {% for module in visible_modules %}
    {% if module.name == 'lists' %}
      <a href="{% url 'index_list' %}" class="nav-item"><span class="nav-icon">&#128221;</span> Seznamy</a>
    {% elif module.name == 'warehouse' %}
      <a href="{% url 'all_stores' %}" class="nav-item"><span class="nav-icon">&#128230;</span> Sklad</a>
    {% elif module.name == 'law_ai' %}
      <a href="{% url 'pravo_ai' %}" class="nav-item"><span class="nav-icon">&#9889;</span> AI Právník</a>
    {% endif %}
  {% endfor %}
  <a href="{% url 'dms_dashboard' %}" class="nav-item"><span class="nav-icon">&#128193;</span> DMS</a>
</div>

<!-- Nastavení Section -->
<div class="nav-section">
  <div class="nav-section-title">Nastavení</div>
  <a href="{% url 'user_settings' %}" class="nav-item"><span class="nav-icon">&#9881;</span> Nastavení účtu</a>
  <a href="{% url 'user_settings' %}" class="nav-item"><span class="nav-icon">&#10133;</span> Zapnout moduly</a>
</div>

{% if user.is_superuser or user.is_staff %}
<div class="nav-section">
  <div class="nav-section-title">Administrace</div>
  <a href="{% url 'admin_modules' %}" class="nav-item"><span class="nav-icon">&#128176;</span> Správa modulů</a>
  <a href="{% url 'admin_subscriptions' %}" class="nav-item"><span class="nav-icon">&#128196;</span> Předplatná</a>
  <a href="{% url 'admin_assign_module' %}" class="nav-item"><span class="nav-icon">&#10133;</span> Přiřadit modul</a>
</div>
{% endif %}

{% else %}
<!-- Menu pro nepřihlášené uživatele -->
<div class="nav-section">
  <div class="nav-section-title">Oblíbené moduly</div>
  <a href="{% url 'module_project_management' %}" class="nav-item" title="Zjistit více o správě projektů">
    <span class="nav-icon">&#128295;</span> Správa projektů
  </a>
  <a href="{% url 'module_grants' %}" class="nav-item" title="Zjistit více o grantech a dotacích">
    <span class="nav-icon">&#128176;</span> Granty a dotace
  </a>
  <a href="{% url 'module_accounting' %}" class="nav-item" title="Zjistit více o účetnictví">
    <span class="nav-icon">&#128202;</span> Účetnictví
  </a>
  <a href="{% url 'module_law_ai' %}" class="nav-item" title="Zjistit více o AI Právníkovi">
    <span class="nav-icon">&#9889;</span> AI Právník
  </a>
  <a href="{% url 'dms_public' %}" class="nav-item" title="Zjistit více o DMS">
    <span class="nav-icon">&#128193;</span> DMS
  </a>
</div>

<div class="nav-section">
  <div class="nav-section-title">Účet</div>
  <a href="{% url 'login_cs' %}" class="nav-item">
    <span class="nav-icon">&#128273;</span> Přihlásit se
  </a>
  <a href="{% url 'registration_cs' %}" class="nav-item">
    <span class="nav-icon">&#128221;</span> Registrace
  </a>
</div>
{% endif %}
