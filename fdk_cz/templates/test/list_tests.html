{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "TestovÃ¡nÃ­" %} | FDK.cz{% endblock %}
{% block header_title %}ğŸ§ª {% trans "TestovÃ¡nÃ­" %}{% endblock %}
{% block header_subtitle %}{% trans "SprÃ¡va testÅ¯, typÅ¯ testÅ¯ a chyb" %}{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
  <!-- Testy -->
  <div class="content-card mb-6">
    <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
      <h3 class="card-title" style="font-weight:600;font-size:1.1rem;">ğŸ§ª {% trans "Testy" %}</h3>
      <a href="{% url 'create_test' %}" class="btn btn-primary text-sm">&#10133; {% trans "NovÃ½ test" %}</a>
    </div>
    {% if tests %}
    <div class="overflow-x-auto">
      <table class="data-table">
        <thead>
          <tr>
            <th>{% trans "NÃ¡zev" %}</th>
            <th class="hidden md:table-cell">{% trans "Popis" %}</th>
            <th>{% trans "Typ" %}</th>
            <th class="hidden md:table-cell">{% trans "Projekt" %}</th>
            <th class="text-right">{% trans "Akce" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for test in tests %}
          <tr>
            <td>
              <a href="{% url 'edit_test' test.test_id %}" class="font-semibold text-blue-600 hover:underline">
                {{ test.name }}
              </a>
            </td>
            <td class="hidden md:table-cell text-gray-600">{{ test.description|truncatewords:10|default:"â€“" }}</td>
            <td><span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-semibold">{{ test.test_type.name }}</span></td>
            <td class="hidden md:table-cell text-gray-600">{{ test.project.name }}</td>
            <td class="text-right">
              <div class="data-table-actions">
                <a href="{% url 'edit_test' test.test_id %}">ğŸ‘ï¸ {% trans "Detail" %}</a>
                <a href="{% url 'edit_test' test.test_id %}">âœï¸ {% trans "Upravit" %}</a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="empty-state" style="text-align:center;padding:2rem;color:#6b7280;">
      <div style="font-size:2rem;">ğŸ§ª</div>
      <p style="margin-top:0.5rem;">{% trans "ZatÃ­m nemÃ¡te vytvoÅ™enÃ© Å¾Ã¡dnÃ© testy." %}</p>
      <a href="{% url 'create_test' %}" class="btn btn-outline" style="margin-top:1rem;">â• {% trans "VytvoÅ™it prvnÃ­ test" %}</a>
    </div>
    {% endif %}
  </div>

  <!-- Typy testÅ¯ -->
  <div class="content-card mb-6">
    <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
      <h3 class="card-title" style="font-weight:600;font-size:1.1rem;">ğŸ·ï¸ {% trans "DostupnÃ© typy testÅ¯" %}</h3>
      <a href="{% url 'create_test_type' %}" class="btn btn-primary text-sm">&#10133; {% trans "NovÃ½ typ testu" %}</a>
    </div>
    {% if test_types %}
    <div class="overflow-x-auto">
      <table class="data-table">
        <thead>
          <tr>
            <th>{% trans "NÃ¡zev" %}</th>
            <th class="hidden md:table-cell">{% trans "Popis" %}</th>
            <th class="hidden md:table-cell">{% trans "Projekt" %}</th>
            <th class="text-right">{% trans "Akce" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for test_type in test_types %}
          <tr>
            <td>
              <a href="{% url 'edit_test_type' test_type.test_type_id %}" class="font-semibold text-blue-600 hover:underline">
                {{ test_type.name }}
              </a>
            </td>
            <td class="hidden md:table-cell text-gray-600">{{ test_type.description|truncatewords:10|default:"â€“" }}</td>
            <td class="hidden md:table-cell text-gray-600">{{ test_type.project.name }}</td>
            <td class="text-right">
              <div class="data-table-actions">
                <a href="{% url 'edit_test_type' test_type.test_type_id %}">ğŸ‘ï¸ {% trans "Detail" %}</a>
                <a href="{% url 'edit_test_type' test_type.test_type_id %}">âœï¸ {% trans "Upravit" %}</a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="empty-state" style="text-align:center;padding:2rem;color:#6b7280;">
      <div style="font-size:2rem;">ğŸ·ï¸</div>
      <p style="margin-top:0.5rem;">{% trans "Å½Ã¡dnÃ© typy testÅ¯ nejsou k dispozici." %}</p>
      <a href="{% url 'create_test_type' %}" class="btn btn-outline" style="margin-top:1rem;">â• {% trans "PÅ™idat typ testu" %}</a>
    </div>
    {% endif %}
  </div>

  <!-- AktivnÃ­ chyby -->
  <div class="content-card">
    <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
      <h3 class="card-title" style="font-weight:600;font-size:1.1rem;">ğŸ› {% trans "PoslednÃ­ch 10 aktivnÃ­ch chyb" %}</h3>
      <a href="{% url 'create_test_error' %}" class="btn btn-primary text-sm">&#10133; {% trans "NovÃ¡ chyba" %}</a>
    </div>
    {% if test_errors %}
    <div class="overflow-x-auto">
      <table class="data-table">
        <thead>
          <tr>
            <th>{% trans "NÃ¡zev chyby" %}</th>
            <th>{% trans "Status" %}</th>
            <th class="hidden md:table-cell">{% trans "Autor" %}</th>
            <th class="text-right">{% trans "Akce" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for error in test_errors %}
          <tr>
            <td>
              <a href="{% url 'detail_test_error' error.test_error_id %}" class="font-semibold text-blue-600 hover:underline">
                {{ error.error_title }}
              </a>
            </td>
            <td>
              <span class="px-2 py-1 {% if error.status == 'open' %}bg-yellow-100 text-yellow-700{% elif error.status == 'closed' %}bg-green-100 text-green-700{% else %}bg-gray-100 text-gray-700{% endif %} rounded text-xs font-semibold">
                {{ error.get_status_display }}
              </span>
            </td>
            <td class="hidden md:table-cell text-gray-600">{% if error.created_by %}{{ error.created_by.username }}{% else %}{% trans "NeznÃ¡mÃ½" %}{% endif %}</td>
            <td class="text-right">
              <div class="data-table-actions">
                <a href="{% url 'detail_test_error' error.test_error_id %}">ğŸ‘ï¸ {% trans "Detail" %}</a>
                <a href="{% url 'edit_test_error' error.test_error_id %}">âœï¸ {% trans "Upravit" %}</a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="empty-state" style="text-align:center;padding:2rem;color:#6b7280;">
      <div style="font-size:2rem;">ğŸ›</div>
      <p style="margin-top:0.5rem;">{% trans "Å½Ã¡dnÃ© aktivnÃ­ chyby." %}</p>
      <a href="{% url 'create_test_error' %}" class="btn btn-outline" style="margin-top:1rem;">â• {% trans "PÅ™idat chybu" %}</a>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
