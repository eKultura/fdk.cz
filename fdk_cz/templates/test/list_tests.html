{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "TestovÃ¡nÃ­" %} | FDK.cz{% endblock %}
{% block header_title %}ğŸ§ª {% trans "TestovÃ¡nÃ­" %}{% endblock %}
{% block header_subtitle %}{% trans "SprÃ¡va testÅ¯, typÅ¯ testÅ¯ a chyb" %}{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
  <!-- Testy -->
  <div class="content-card mb-6">
    <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
      <h3 class="card-title" style="font-weight:600;font-size:1.1rem;">ğŸ§ª {% trans "Testy" %}</h3>
      <a href="{% url 'create_test' %}" class="btn btn-primary text-sm">&#10133; {% trans "NovÃ½ test" %}</a>
    </div>
    {% if tests %}
    <div class="overflow-x-auto">
      <table class="data-table" style="width:100%;border-collapse:collapse;">
        <thead style="background:#f9fafb;">
          <tr>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold">{% trans "NÃ¡zev" %}</th>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold hidden md:table-cell">{% trans "Popis" %}</th>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold">{% trans "Typ" %}</th>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold hidden md:table-cell">{% trans "Projekt" %}</th>
            <th class="px-4 py-2 text-center text-gray-600 font-semibold w-1/6">{% trans "Akce" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for test in tests %}
          <tr style="border-bottom:1px solid #e5e7eb;" class="hover:bg-gray-50 transition">
            <td class="px-4 py-2 text-gray-800 font-medium">{{ test.name }}</td>
            <td class="px-4 py-2 text-gray-500 hidden md:table-cell">{{ test.description|truncatewords:10|default:"â€“" }}</td>
            <td class="px-4 py-2"><span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm">{{ test.test_type.name }}</span></td>
            <td class="px-4 py-2 text-gray-500 hidden md:table-cell">{{ test.project.name }}</td>
            <td class="px-4 py-2 text-center">
              <a href="{% url 'edit_test' test.test_id %}" class="text-yellow-600 hover:text-yellow-800 text-sm">{% trans "Upravit" %}</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="empty-state" style="text-align:center;padding:2rem;color:#6b7280;">
      <div style="font-size:2rem;">ğŸ§ª</div>
      <p style="margin-top:0.5rem;">{% trans "ZatÃ­m nemÃ¡te vytvoÅ™enÃ© Å¾Ã¡dnÃ© testy." %}</p>
      <a href="{% url 'create_test' %}" class="btn btn-outline" style="margin-top:1rem;">â• {% trans "VytvoÅ™it prvnÃ­ test" %}</a>
    </div>
    {% endif %}
  </div>

  <!-- Typy testÅ¯ -->
  <div class="content-card mb-6">
    <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
      <h3 class="card-title" style="font-weight:600;font-size:1.1rem;">ğŸ·ï¸ {% trans "DostupnÃ© typy testÅ¯" %}</h3>
      <a href="{% url 'create_test_type' %}" class="btn btn-primary text-sm">&#10133; {% trans "NovÃ½ typ testu" %}</a>
    </div>
    {% if test_types %}
    <div class="overflow-x-auto">
      <table class="data-table" style="width:100%;border-collapse:collapse;">
        <thead style="background:#f9fafb;">
          <tr>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold">{% trans "NÃ¡zev" %}</th>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold hidden md:table-cell">{% trans "Popis" %}</th>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold hidden md:table-cell">{% trans "Projekt" %}</th>
            <th class="px-4 py-2 text-center text-gray-600 font-semibold w-1/6">{% trans "Akce" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for test_type in test_types %}
          <tr style="border-bottom:1px solid #e5e7eb;" class="hover:bg-gray-50 transition">
            <td class="px-4 py-2 text-gray-800 font-medium">{{ test_type.name }}</td>
            <td class="px-4 py-2 text-gray-500 hidden md:table-cell">{{ test_type.description|truncatewords:10|default:"â€“" }}</td>
            <td class="px-4 py-2 text-gray-500 hidden md:table-cell">{{ test_type.project.name }}</td>
            <td class="px-4 py-2 text-center">
              <a href="{% url 'edit_test_type' test_type.test_type_id %}" class="text-yellow-600 hover:text-yellow-800 text-sm">{% trans "Upravit" %}</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="empty-state" style="text-align:center;padding:2rem;color:#6b7280;">
      <div style="font-size:2rem;">ğŸ·ï¸</div>
      <p style="margin-top:0.5rem;">{% trans "Å½Ã¡dnÃ© typy testÅ¯ nejsou k dispozici." %}</p>
      <a href="{% url 'create_test_type' %}" class="btn btn-outline" style="margin-top:1rem;">â• {% trans "PÅ™idat typ testu" %}</a>
    </div>
    {% endif %}
  </div>

  <!-- AktivnÃ­ chyby -->
  <div class="content-card">
    <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
      <h3 class="card-title" style="font-weight:600;font-size:1.1rem;">ğŸ› {% trans "PoslednÃ­ch 10 aktivnÃ­ch chyb" %}</h3>
      <a href="{% url 'create_test_error' %}" class="btn btn-primary text-sm">&#10133; {% trans "NovÃ¡ chyba" %}</a>
    </div>
    {% if test_errors %}
    <div class="overflow-x-auto">
      <table class="data-table" style="width:100%;border-collapse:collapse;">
        <thead style="background:#f9fafb;">
          <tr>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold">{% trans "NÃ¡zev chyby" %}</th>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold">{% trans "Status" %}</th>
            <th class="px-4 py-2 text-left text-gray-600 font-semibold hidden md:table-cell">{% trans "Autor" %}</th>
            <th class="px-4 py-2 text-center text-gray-600 font-semibold w-1/6">{% trans "Akce" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for error in test_errors %}
          <tr style="border-bottom:1px solid #e5e7eb;" class="hover:bg-gray-50 transition">
            <td class="px-4 py-2 text-gray-800 font-medium">{{ error.error_title }}</td>
            <td class="px-4 py-2">
              <span class="px-2 py-1 {% if error.status == 'open' %}bg-yellow-100 text-yellow-700{% elif error.status == 'closed' %}bg-green-100 text-green-700{% else %}bg-gray-100 text-gray-700{% endif %} rounded text-sm">
                {{ error.get_status_display }}
              </span>
            </td>
            <td class="px-4 py-2 text-gray-500 hidden md:table-cell">{% if error.created_by %}{{ error.created_by.username }}{% else %}{% trans "NeznÃ¡mÃ½" %}{% endif %}</td>
            <td class="px-4 py-2 text-center">
              <a href="{% url 'detail_test_error' error.test_error_id %}" class="text-blue-600 hover:text-blue-800 text-sm mr-2">{% trans "Detail" %}</a>
              <a href="{% url 'edit_test_error' error.test_error_id %}" class="text-yellow-600 hover:text-yellow-800 text-sm">{% trans "Upravit" %}</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="empty-state" style="text-align:center;padding:2rem;color:#6b7280;">
      <div style="font-size:2rem;">ğŸ›</div>
      <p style="margin-top:0.5rem;">{% trans "Å½Ã¡dnÃ© aktivnÃ­ chyby." %}</p>
      <a href="{% url 'create_test_error' %}" class="btn btn-outline" style="margin-top:1rem;">â• {% trans "PÅ™idat chybu" %}</a>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
