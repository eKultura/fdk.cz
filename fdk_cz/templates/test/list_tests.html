{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Testov√°n√≠" %} | FDK.cz{% endblock %}
{% block header_title %}üß™ {% trans "Testov√°n√≠" %}{% endblock %}
{% block header_subtitle %}{% trans "Spr√°va test≈Ø, typ≈Ø test≈Ø a chyb" %}{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
  <!-- Actions -->
  <div class="mb-10 flex gap-3">
    <a href="{% url 'create_test' %}" class="btn btn-primary">+ {% trans "Nov√Ω test" %}</a>
    <a href="{% url 'create_test_type' %}" class="btn btn-outline">+ {% trans "Nov√Ω typ testu" %}</a>
    <a href="{% url 'create_test_error' %}" class="btn btn-outline">+ {% trans "Nov√° chyba" %}</a>
  </div>

  <!-- Testy -->
  <div class="content-card mb-6">
    <h3 class="text-xl font-semibold mb-4">{% trans "Testy" %}</h3>
    {% if tests %}
    <div class="overflow-x-auto">
      <table class="table">
        <thead>
          <tr>
            <th>{% trans "N√°zev" %}</th>
            <th>{% trans "Popis" %}</th>
            <th>{% trans "Typ" %}</th>
            <th>{% trans "Projekt" %}</th>
            <th class="text-center">{% trans "Akce" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for test in tests %}
          <tr>
            <td class="font-medium">{{ test.name }}</td>
            <td>{{ test.description|truncatewords:10|default:"‚Äî" }}</td>
            <td><span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm">{{ test.test_type.name }}</span></td>
            <td>{{ test.project.name }}</td>
            <td class="text-center">
              <a href="{% url 'edit_test' test.test_id %}" class="btn btn-outline btn-sm">‚úèÔ∏è {% trans "Upravit" %}</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="text-center py-12 bg-gray-50 rounded-lg">
      <div class="text-5xl mb-3">üß™</div>
      <h4 class="text-lg font-semibold text-gray-700 mb-2">{% trans "≈Ω√°dn√© testy" %}</h4>
      <p class="text-gray-600 mb-4">{% trans "Zat√≠m nem√°te vytvo≈ôen√© ≈æ√°dn√© testy." %}</p>
      <a href="{% url 'create_test' %}" class="btn btn-primary">+ {% trans "Vytvo≈ôit prvn√≠ test" %}</a>
    </div>
    {% endif %}
  </div>

  <!-- Typy test≈Ø -->
  <div class="content-card mb-6">
    <h3 class="text-xl font-semibold mb-4">{% trans "Dostupn√© typy test≈Ø" %}</h3>
    {% if test_types %}
    <div class="overflow-x-auto">
      <table class="table">
        <thead>
          <tr>
            <th>{% trans "N√°zev" %}</th>
            <th>{% trans "Popis" %}</th>
            <th>{% trans "Projekt" %}</th>
            <th class="text-center">{% trans "Akce" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for test_type in test_types %}
          <tr>
            <td class="font-medium">{{ test_type.name }}</td>
            <td>{{ test_type.description|truncatewords:10|default:"‚Äî" }}</td>
            <td>{{ test_type.project.name }}</td>
            <td class="text-center">
              <a href="{% url 'edit_test_type' test_type.test_type_id %}" class="btn btn-outline btn-sm">‚úèÔ∏è {% trans "Upravit" %}</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="text-center py-8 bg-gray-50 rounded-lg">
      <p class="text-gray-600 mb-3">{% trans "≈Ω√°dn√© typy test≈Ø nejsou k dispozici." %}</p>
      <a href="{% url 'create_test_type' %}" class="btn btn-outline btn-sm">+ {% trans "P≈ôidat typ testu" %}</a>
    </div>
    {% endif %}
  </div>

  <!-- Aktivn√≠ chyby -->
  <div class="content-card">
    <h3 class="text-xl font-semibold mb-4">{% trans "Posledn√≠ch 10 aktivn√≠ch chyb" %}</h3>
    {% if test_errors %}
    <div class="overflow-x-auto">
      <table class="table">
        <thead>
          <tr>
            <th>{% trans "N√°zev chyby" %}</th>
            <th>{% trans "Status" %}</th>
            <th>{% trans "Autor" %}</th>
            <th class="text-center">{% trans "Akce" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for error in test_errors %}
          <tr>
            <td class="font-medium">{{ error.error_title }}</td>
            <td>
              <span class="px-2 py-1 {% if error.status == 'open' %}bg-yellow-100 text-yellow-700{% elif error.status == 'closed' %}bg-green-100 text-green-700{% else %}bg-gray-100 text-gray-700{% endif %} rounded text-sm">
                {{ error.status }}
              </span>
            </td>
            <td>{% if error.created_by %}{{ error.created_by.username }}{% else %}{% trans "Nezn√°m√Ω" %}{% endif %}</td>
            <td class="text-center">
              <a href="{% url 'detail_test_error' error.test_error_id %}" class="btn btn-outline btn-sm">üëÅÔ∏è {% trans "Detail" %}</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="text-center py-8 bg-gray-50 rounded-lg">
      <p class="text-gray-600 mb-3">{% trans "≈Ω√°dn√© aktivn√≠ chyby." %}</p>
      <a href="{% url 'create_test_error' %}" class="btn btn-outline btn-sm">+ {% trans "P≈ôidat chybu" %}</a>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
