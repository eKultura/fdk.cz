{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "TestovÃ¡nÃ­" %} | FDK.cz{% endblock %}
{% block header_title %}ğŸ§ª {% trans "TestovÃ¡nÃ­" %}{% endblock %}
{% block header_subtitle %}{% trans "SprÃ¡va testÅ¯, typÅ¯ testÅ¯ a chyb" %}{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
  <!-- Actions -->
  <div class="content-card mb-6">
    <div class="flex flex-wrap gap-3">
      <a href="{% url 'create_test' %}" class="btn btn-primary">+ {% trans "NovÃ½ test" %}</a>
      <a href="{% url 'create_test_type' %}" class="btn btn-secondary">+ {% trans "NovÃ½ typ testu" %}</a>
      <a href="{% url 'create_test_error' %}" class="btn btn-outline">+ {% trans "NovÃ¡ chyba" %}</a>
      <a href="{% url 'list_test_types' %}" class="btn btn-outline">ğŸ“‹ {% trans "VÅ¡echny typy testÅ¯" %}</a>
    </div>
  </div>

  <!-- Testy -->
  <div class="content-card mb-6">
    <h3 class="text-xl font-semibold mb-4">ğŸ§ª {% trans "Testy" %}</h3>
    {% if tests %}
    <div class="overflow-x-auto">
      <table class="data-table">
        <thead>
          <tr>
            <th>{% trans "NÃ¡zev" %}</th>
            <th>{% trans "Popis" %}</th>
            <th>{% trans "Typ" %}</th>
            <th>{% trans "Projekt" %}</th>
            <th class="text-right">{% trans "Akce" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for test in tests %}
          <tr>
            <td><strong>{{ test.name }}</strong></td>
            <td>{{ test.description|truncatewords:10|default:"â€”" }}</td>
            <td><span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm">{{ test.test_type.name }}</span></td>
            <td>{{ test.project.name }}</td>
            <td class="text-right">
              <div class="data-table-actions">
                <a href="{% url 'edit_test' test.test_id %}">âœï¸ {% trans "Upravit" %}</a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="text-center py-12 bg-gray-50 rounded-lg">
      <div class="text-5xl mb-3">ğŸ§ª</div>
      <h4 class="text-lg font-semibold text-gray-700 mb-2">{% trans "Å½Ã¡dnÃ© testy" %}</h4>
      <p class="text-gray-600 mb-4">{% trans "ZatÃ­m nemÃ¡te vytvoÅ™enÃ© Å¾Ã¡dnÃ© testy." %}</p>
      <a href="{% url 'create_test' %}" class="btn btn-primary">+ {% trans "VytvoÅ™it prvnÃ­ test" %}</a>
    </div>
    {% endif %}
  </div>

  <!-- Typy testÅ¯ -->
  <div class="content-card mb-6">
    <h3 class="text-xl font-semibold mb-4">ğŸ·ï¸ {% trans "DostupnÃ© typy testÅ¯" %}</h3>
    {% if test_types %}
    <div class="overflow-x-auto">
      <table class="data-table">
        <thead>
          <tr>
            <th>{% trans "NÃ¡zev" %}</th>
            <th>{% trans "Popis" %}</th>
            <th>{% trans "Projekt" %}</th>
            <th class="text-right">{% trans "Akce" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for test_type in test_types %}
          <tr>
            <td><strong>{{ test_type.name }}</strong></td>
            <td>{{ test_type.description|truncatewords:10|default:"â€”" }}</td>
            <td>{{ test_type.project.name }}</td>
            <td class="text-right">
              <div class="data-table-actions">
                <a href="{% url 'edit_test_type' test_type.test_type_id %}">âœï¸ {% trans "Upravit" %}</a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="text-center py-8 bg-gray-50 rounded-lg">
      <p class="text-gray-600 mb-3">{% trans "Å½Ã¡dnÃ© typy testÅ¯ nejsou k dispozici." %}</p>
      <a href="{% url 'create_test_type' %}" class="btn btn-outline btn-sm">+ {% trans "PÅ™idat typ testu" %}</a>
    </div>
    {% endif %}
  </div>

  <!-- AktivnÃ­ chyby -->
  <div class="content-card">
    <h3 class="text-xl font-semibold mb-4">ğŸ› {% trans "PoslednÃ­ch 10 aktivnÃ­ch chyb" %}</h3>
    {% if test_errors %}
    <div class="overflow-x-auto">
      <table class="data-table">
        <thead>
          <tr>
            <th>{% trans "NÃ¡zev chyby" %}</th>
            <th>{% trans "Status" %}</th>
            <th>{% trans "Autor" %}</th>
            <th class="text-right">{% trans "Akce" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for error in test_errors %}
          <tr>
            <td><strong>{{ error.error_title }}</strong></td>
            <td>
              <span class="px-2 py-1 {% if error.status == 'open' %}bg-yellow-100 text-yellow-700{% elif error.status == 'closed' %}bg-green-100 text-green-700{% else %}bg-gray-100 text-gray-700{% endif %} rounded text-sm">
                {{ error.get_status_display }}
              </span>
            </td>
            <td>{% if error.created_by %}{{ error.created_by.username }}{% else %}{% trans "NeznÃ¡mÃ½" %}{% endif %}</td>
            <td class="text-right">
              <div class="data-table-actions">
                <a href="{% url 'detail_test_error' error.test_error_id %}">ğŸ‘ï¸ {% trans "Detail" %}</a>
                <a href="{% url 'edit_test_error' error.test_error_id %}">âœï¸ {% trans "Upravit" %}</a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="text-center py-8 bg-gray-50 rounded-lg">
      <p class="text-gray-600 mb-3">{% trans "Å½Ã¡dnÃ© aktivnÃ­ chyby." %}</p>
      <a href="{% url 'create_test_error' %}" class="btn btn-outline btn-sm">+ {% trans "PÅ™idat chybu" %}</a>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
