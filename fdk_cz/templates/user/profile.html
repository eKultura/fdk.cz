{% extends "base.html" %}
{% load i18n %}

{% block title %}Profil | FDK.cz{% endblock %}
{% block header_title %}ğŸ‘¤ MÅ¯j profil{% endblock %}
{% block header_subtitle %}{{ user.first_name }} {{ user.last_name }} Â· {{ user.email }}{% endblock %}

{% block content %}
<div style="max-width: 1200px; margin: 0 auto;">

  <!-- Profile Header Card -->
  <div class="content-card" style="background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-left: 4px solid #3b82f6;">
    <div style="display: flex; align-items: center; gap: 2rem;">
      <div style="width: 100px; height: 100px; border-radius: 50%; background: linear-gradient(135deg, #3b82f6, #1d4ed8); display: flex; align-items: center; justify-content: center; color: white; font-size: 2.5rem; font-weight: 700; border: 4px solid white; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
        {% if user.profile.photo %}
          <img src="{{ user.profile.photo.url }}" alt="Foto" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">
        {% else %}
          {{ user.first_name|first|default:user.username|first|upper }}
        {% endif %}
      </div>

      <div style="flex: 1;">
        <h2 style="font-size: 1.75rem; font-weight: 700; margin-bottom: 0.5rem; color: #1e293b;">
          {{ user.first_name }} {{ user.last_name }}
        </h2>
        <p style="color: #475569; margin-bottom: 1rem;">
          @{{ user.username }} Â· {{ user.email }}
        </p>

        <div style="display: flex; gap: 1rem;">
          <a href="{% url 'user_settings' %}" class="btn btn-primary">âš™ï¸ Upravit profil</a>
          <a href="{% url 'logout' %}" class="btn btn-outline">ğŸšª OdhlÃ¡sit se</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Profile Information Grid -->
  <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; margin-top: 1.5rem;">

    <!-- Personal Information -->
    <div class="content-card">
      <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; color: #1e293b;">
        ğŸ“‹ OsobnÃ­ informace
      </h3>

      <div class="data-table-simple">
        <div class="data-row">
          <span class="data-label">UÅ¾ivatelskÃ© jmÃ©no</span>
          <span class="data-value">{{ user.username }}</span>
        </div>
        <div class="data-row">
          <span class="data-label">JmÃ©no</span>
          <span class="data-value">{{ user.first_name|default:"Nenastaveno" }}</span>
        </div>
        <div class="data-row">
          <span class="data-label">PÅ™Ã­jmenÃ­</span>
          <span class="data-value">{{ user.last_name|default:"Nenastaveno" }}</span>
        </div>
        <div class="data-row">
          <span class="data-label">Email</span>
          <span class="data-value">{{ user.email|default:"NenÃ­ nastaven" }}</span>
        </div>
        <div class="data-row">
          <span class="data-label">Telefon</span>
          <span class="data-value">{{ user.profile.phone_number|default:"Nenastaveno" }}</span>
        </div>
        <div class="data-row">
          <span class="data-label">Lokalita</span>
          <span class="data-value">{{ user.profile.location|default:"Nenastaveno" }}</span>
        </div>
      </div>
    </div>

    <!-- Account Stats -->
    <div class="content-card">
      <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; color: #1e293b;">
        ğŸ“Š Statistiky ÃºÄtu
      </h3>

      <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
        <div style="background: #f8fafc; border-radius: 8px; padding: 1rem; text-align: center;">
          <div style="font-size: 2rem; font-weight: 700; color: #3b82f6;">{{ user.owned_projects.count }}</div>
          <div style="font-size: 0.875rem; color: #64748b;">VlastnÄ›nÃ© projekty</div>
        </div>

        <div style="background: #f8fafc; border-radius: 8px; padding: 1rem; text-align: center;">
          <div style="font-size: 2rem; font-weight: 700; color: #10b981;">{{ user.project_memberships.count }}</div>
          <div style="font-size: 0.875rem; color: #64748b;">ÄŒlenstvÃ­ v projektech</div>
        </div>

        <div style="background: #f8fafc; border-radius: 8px; padding: 1rem; text-align: center;">
          <div style="font-size: 2rem; font-weight: 700; color: #f59e0b;">{{ user.assigned_tasks.count }}</div>
          <div style="font-size: 0.875rem; color: #64748b;">PÅ™iÅ™azenÃ© Ãºkoly</div>
        </div>

        <div style="background: #f8fafc; border-radius: 8px; padding: 1rem; text-align: center;">
          <div style="font-size: 2rem; font-weight: 700; color: #8b5cf6;">{{ user.created_organizations.count }}</div>
          <div style="font-size: 0.875rem; color: #64748b;">Organizace</div>
        </div>
      </div>
    </div>

  </div>

  <!-- Active Modules -->
  <div class="content-card" style="margin-top: 1.5rem;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
      <h3 style="font-size: 1.25rem; font-weight: 600; color: #1e293b;">
        ğŸ”§ AktivnÃ­ moduly
      </h3>
      <a href="{% url 'user_settings' %}" class="btn btn-outline btn-sm">Spravovat moduly</a>
    </div>

    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
      {% for module in user.visible_modules.all %}
        <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 1rem; display: flex; align-items: center; gap: 0.75rem;">
          <span style="font-size: 1.5rem;">{{ module.icon|default:"ğŸ“¦" }}</span>
          <div style="flex: 1;">
            <div style="font-weight: 600; color: #1e293b;">{{ module.display_name }}</div>
            <div style="font-size: 0.75rem; color: #64748b;">{{ module.description|truncatewords:5 }}</div>
          </div>
        </div>
      {% empty %}
        <div style="grid-column: 1 / -1; text-align: center; padding: 2rem; color: #64748b;">
          NemÃ¡te Å¾Ã¡dnÃ© aktivnÃ­ moduly
        </div>
      {% endfor %}
    </div>
  </div>

</div>

<style>
  .data-table-simple {
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    overflow: hidden;
  }

  .data-row {
    display: flex;
    justify-content: space-between;
    padding: 0.75rem 1rem;
    border-bottom: 1px solid #f1f5f9;
  }

  .data-row:last-child {
    border-bottom: none;
  }

  .data-row:hover {
    background: #f8fafc;
  }

  .data-label {
    font-weight: 600;
    color: #475569;
  }

  .data-value {
    color: #1e293b;
  }
</style>
{% endblock %}
