{% load static %}
{% load i18n %}
<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="icon" type="image/png" href="{% static 'assets/img/favicon.png' %}">
  <title>Přihlášení | FDK.cz</title>
  
  <!-- Fonts -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" />
  
  <!-- Unified CSS -->
  <style>
    {% include 'inc/style.css' %}
  </style>
</head>

<body class="login-background">
  <!-- Messages Block - jednotný pro všechny stránky -->
  {% if messages %}
  <div style="position: fixed; top: 110px; right: 20px; z-index: 1100; max-width: 400px;">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }}" style="margin-bottom: 0.5rem; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
      {{ message }}
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <!-- Header -->
  <header class="header floating">
    <a href="{% url 'index' %}" class="logo">
      <div class="logo-icon">&#9873;</div>
      FDK.cz
    </a>

    <nav class="top-nav">
      <a href="{% url 'index' %}" class="nav-link">
        &#128202; Dashboard
      </a>
      <a href="{% url 'user_profile' %}" class="nav-link">
        &#128100; Profil
      </a>
      <a href="{% url 'login_cs' %}" class="nav-link active">
        &#128273; Přihlášení
      </a>
      <a href="{% url 'registration_cs' %}" class="nav-link">
        &#128221; Registrace
      </a>
    </nav>

    <div>
      <a href="https://ekultura.eu" class="btn btn-outline login-style" target="_blank">
        eKultura
      </a>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content with-floating-header">
    <div class="login-container">
      <div class="login-card">
        <div class="login-header">
          <h1 class="login-title">Přihlášení</h1>
          <p class="login-subtitle">Přihlaste se do systému FDK.cz</p>
          
          <div class="social-buttons">
            
              &#128279;
              &nbsp;&nbsp;&nbsp;
              &#128187;
              &nbsp;&nbsp;&nbsp;
              &#128269;

          </div>
        </div>

        <div class="login-body">
          {% if user.is_authenticated %}
          <!-- Logged in state -->
          <div class="logged-in-card">
            <div class="user-avatar large">
              {{ user.first_name|first|default:user.username|first|upper }}
            </div>
            <div class="alert alert-success">
              {% trans "Přihlášen jako" %} <strong>{{ user.username }}</strong>
            </div>
            <p class="login-footer">
              <a href="{% url 'logout_cs' %}">{% trans "Odhlásit" %}</a> 
              nebo 
              <a href="{% url 'index' %}">přejít na Dashboard</a>
            </p>
          </div>
          
          {% else %}
          <!-- Login form -->
          <form method="post" action="{% url 'login_cs' %}">
            {% csrf_token %}
            
            <div class="form-group">
              <label for="id_username" class="form-label">
                {% trans "Uživatelské jméno" %}
              </label>
              <input 
                type="text" 
                name="username" 
                id="id_username" 
                required 
                class="form-control"
                placeholder="Zadejte uživatelské jméno"
              >
            </div>

            <div class="form-group">
              <label for="id_password" class="form-label">
                {% trans "Heslo" %}
              </label>
              <div class="password-toggle">
                <input 
                  type="password" 
                  name="password" 
                  id="id_password" 
                  required 
                  class="form-control"
                  placeholder="Zadejte heslo"
                >
                <button 
                  type="button" 
                  class="password-toggle-btn" 
                  onclick="togglePassword('id_password')"
                  title="Zobrazit/skrýt heslo"
                >
                  <span id="password-icon">&#128065;</span>
                </button>
              </div>
            </div>

            <div class="form-check">
              <input 
                class="form-check-input" 
                type="checkbox" 
                id="rememberMe" 
                checked
              >
              <label class="form-check-label" for="rememberMe">
                Zapamatovat si mě
              </label>
            </div>

            <button type="submit" class="login-btn">
              {% trans "Přihlášení" %}
            </button>

            <div class="login-footer">
              {% trans "Nemáte účet?" %}
              <a href="{% url 'registration_cs' %}">{% trans "Registrovat" %}</a>
              <br><br>
              <!--<a href="#">Zapomenuté heslo?</a>-->
            </div>
          </form>
          {% endif %}
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer login-footer">
    <p>
      &copy; {% now "Y" %} Vyrobeno s &#10084;&#65039; pro hladké procesy v 
      <a href="https://ekultura.eu" target="_blank">eKultura</a>
      | 
      <a href="/ochrana-osobnich-udaju">Ochrana osobních údajů</a>
      | 
      <a href="/kontakt">Kontakt</a>
    </p>
  </footer>

  <script>
    // Toggle password visibility
    function togglePassword(fieldId) {
      const passwordField = document.getElementById(fieldId);
      const icon = document.getElementById("password-icon");
      
      if (passwordField.type === "password") {
        passwordField.type = "text";
        icon.innerHTML = "&#128064;"; // Hide icon
      } else {
        passwordField.type = "password";
        icon.innerHTML = "&#128065;"; // Show icon
      }
    }

    // Auto-hide messages after 5 seconds
    document.addEventListener('DOMContentLoaded', function() {
      const alerts = document.querySelectorAll('.alert');
      alerts.forEach(alert => {
        setTimeout(() => {
          alert.style.opacity = '0';
          alert.style.transform = 'translateY(-10px)';
          setTimeout(() => {
            alert.remove();
          }, 300);
        }, 5000);
      });

      // Add focus effects to form inputs
      const inputs = document.querySelectorAll('.form-control');
      inputs.forEach(input => {
        input.addEventListener('focus', function() {
          this.parentElement.classList.add('focused');
        });
        
        input.addEventListener('blur', function() {
          this.parentElement.classList.remove('focused');
        });
      });

      // Add animation to login card
      const loginCard = document.querySelector('.login-card');
      if (loginCard) {
        loginCard.style.opacity = '0';
        loginCard.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
          loginCard.style.transition = 'all 0.6s ease';
          loginCard.style.opacity = '1';
          loginCard.style.transform = 'translateY(0)';
        }, 100);
      }
    });
  </script>
</body>
</html>